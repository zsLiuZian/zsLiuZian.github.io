
<html>
<head>
    <meta charset="UTF-8">
    <title>æˆ‘çš„ç½‘é¡µ</title>
    <style>
        /* åœ¨è¿™é‡Œå†™CSSä»£ç  */
        .markdown-body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
    font-size: 16px;
    line-height: 1.5;
    word-wrap: break-word;
    color: #24292e;
    background-color: #fff;
    max-width: 980px;
    margin: 0 auto;
    padding: 45px;
}

.markdown-body h1, 
.markdown-body h2 {
    padding-bottom: 0.3em;
    border-bottom: 1px solid #eaecef;
}

.markdown-body h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

.markdown-body h2 {
    font-size: 1.5em;
}

.markdown-body h3 {
    font-size: 1.25em;
}

.markdown-body h4 {
    font-size: 1em;
}

.markdown-body h5 {
    font-size: 0.875em;
}

.markdown-body h6 {
    font-size: 0.85em;
    color: #6a737d;
}

.markdown-body p {
    margin-top: 0;
    margin-bottom: 16px;
}

.markdown-body ul, 
.markdown-body ol {
    padding-left: 2em;
    margin-top: 0;
    margin-bottom: 16px;
}

.markdown-body li {
    margin-bottom: 0.25em;
}

.markdown-body blockquote {
    padding: 0 1em;
    color: #6a737d;
    border-left: 0.25em solid #dfe2e5;
    margin: 0 0 16px 0;
}

.markdown-body pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f6f8fa;
    border-radius: 6px;
    margin-bottom: 16px;
}

.markdown-body code {
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
    font-size: 85%;
    background-color: rgba(27,31,35,0.05);
    padding: 0.2em 0.4em;
    border-radius: 3px;
}

.markdown-body pre code {
    background-color: transparent;
    padding: 0;
    border-radius: 0;
}

.markdown-body table {
    border-spacing: 0;
    border-collapse: collapse;
    display: block;
    width: 100%;
    overflow: auto;
    margin-bottom: 16px;
}

.markdown-body th {
    font-weight: 600;
}

.markdown-body th, 
.markdown-body td {
    padding: 6px 13px;
    border: 1px solid #dfe2e5;
}

.markdown-body tr {
    background-color: #fff;
    border-top: 1px solid #c6cbd1;
}

.markdown-body tr:nth-child(2n) {
    background-color: #f6f8fa;
}

.markdown-body img {
    max-width: 100%;
    box-sizing: content-box;
    background-color: #fff;
}

.markdown-body hr {
    height: 0.25em;
    padding: 0;
    margin: 24px 0;
    background-color: #e1e4e8;
    border: 0;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 767px) {
    .markdown-body {
        padding: 15px;
    }
}

/* å¯é€‰ï¼šæ·»åŠ ä¸€äº›åŠ¨ç”»æ•ˆæœ */
.markdown-body a {
    color: #0366d6;
    text-decoration: none;
    transition: color 0.2s ease;
}

.markdown-body a:hover {
    color: #0056b3;
    text-decoration: underline;
}
        /* æ›´å¤šæ ·å¼... */
    </style>
</head>
<body>
<div class="markdown-body">

<h3 class="code-line" data-line-start=0 data-line-end=1 ><a id="01_Rust_0"></a>01 åˆè§Rust</h3>
<h5 class="code-line" data-line-start=2 data-line-end=3 ><a id="Rust_2"></a>Rustå·¥å…·é“¾</h5>
<pre><code class="has-line-data" data-line-start="5" data-line-end="9">rustup update stable
rustup self uninstall
rustup doc //æ‰“å¼€æœ¬åœ°æ–‡æ¡£
</code></pre>
<pre><code class="has-line-data" data-line-start="11" data-line-end="18">cargo new hello
cargo run //å…ˆè°ƒç”¨äº†cargo build
cargo clean //æ¸…é™¤å­˜åœ¨çš„ç¼–è¯‘ç»“æœ
cargo build //é»˜è®¤debug
cargo build --release
cargo check //æ£€æŸ¥è¯­æ³•é”™è¯¯
</code></pre>
<pre><code class="has-line-data" data-line-start="20" data-line-end="23">rustc main.rs
./main
</code></pre>
<h5 class="code-line" data-line-start=24 data-line-end=25 ><a id="_24"></a>å®</h5>
<pre><code class="has-line-data" data-line-start="27" data-line-end="31" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Hello, world!"</span>);
}
</code></pre>
<h5 class="code-line" data-line-start=32 data-line-end=33 ><a id="_32"></a>å‡½æ•°</h5>
<pre><code class="has-line-data" data-line-start="35" data-line-end="48" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">gcd</span></span>(<span class="hljs-keyword">mut</span> x: <span class="hljs-keyword">u64</span>, <span class="hljs-keyword">mut</span> y: <span class="hljs-keyword">u64</span>) -&gt; <span class="hljs-keyword">u64</span> {
    <span class="hljs-built_in">assert!</span>(x != <span class="hljs-number">0</span> &amp;&amp; y != <span class="hljs-number">0</span>);
    <span class="hljs-keyword">while</span> y != <span class="hljs-number">0</span> {
        <span class="hljs-keyword">if</span> x &gt; y {
            <span class="hljs-keyword">let</span> t = x; <span class="hljs-comment">//ç±»å‹æ¨æ–­ï¼ˆlet t: u64 = xï¼‰</span>
            x = y;
            y = t;
        }
        y %= x;
    }
    x
}
</code></pre>
<h5 class="code-line" data-line-start=49 data-line-end=50 ><a id="_49"></a>æµ‹è¯•å‡½æ•°</h5>
<ul>
<li class="has-line-data" data-line-start="51" data-line-end="53">ä»…ç”¨äºæµ‹è¯•ï¼Œæ­£å¸¸æƒ…å†µæ— éœ€ç¼–è¯‘</li>
</ul>
<pre><code class="has-line-data" data-line-start="54" data-line-end="59" class="language-rust"><span class="hljs-preprocessor">#[test]</span> <span class="hljs-comment">//ç§°ä¸ºattribute</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">test_gcd</span></span>() {
    <span class="hljs-built_in">assert_eq!</span>(gcd(<span class="hljs-number">14</span>, <span class="hljs-number">15</span>), <span class="hljs-number">1</span>);
}
</code></pre>
<pre><code class="has-line-data" data-line-start="61" data-line-end="63">cargo test
</code></pre>
<h5 class="code-line" data-line-start=64 data-line-end=65 ><a id="_64"></a>å‘½ä»¤è¡Œå‚æ•°</h5>
<pre><code class="has-line-data" data-line-start="67" data-line-end="89" class="language-rust"><span class="hljs-keyword">use</span> std::env;
<span class="hljs-keyword">use</span> std::str::FromStr;

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> a = Vec::new();
    <span class="hljs-keyword">for</span> arg <span class="hljs-keyword">in</span> env::args().skip(<span class="hljs-number">1</span>) { <span class="hljs-comment">//è·å¾—å‚æ•°ï¼Œå¿½ç•¥ç¬¬ä¸€ä¸ª</span>
        a.push(u64::from_str(&amp;arg).expect(<span class="hljs-string">"error parsing argument"</span>));
    }

    <span class="hljs-keyword">if</span> a.len() == <span class="hljs-number">0</span> {
        eprintln!(<span class="hljs-string">"Usage: gcd NUMBER ..."</span>); <span class="hljs-comment">//å†™å…¥æ ‡å‡†é”™è¯¯</span>
        std::process::exit(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> d = a[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &amp;a[<span class="hljs-number">1</span>..] {
        d = gcd1(d, *i);
    }
    
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?} çš„æœ€å¤§å…¬çº¦æ•°æ˜¯ {}"</span>, a, d);
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="90" data-line-end="91">stdï¼ša crate</li>
<li class="has-line-data" data-line-start="91" data-line-end="92">envï¼ša module in std</li>
<li class="has-line-data" data-line-start="92" data-line-end="94">FromStrï¼ša trait in std::str</li>
</ul>
<pre><code class="has-line-data" data-line-start="95" data-line-end="100" class="language-rust">pub trait FromStr {
    type Err;
    fn from_str(s: &amp;str) -&gt; Result&lt;Self, Self::Err&gt;;
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="101" data-line-end="102">Vecï¼ša struct in std::vecï¼›re-exported by std::prelude</li>
<li class="has-line-data" data-line-start="102" data-line-end="104">newï¼ša method in Vec</li>
</ul>
<h5 class="code-line" data-line-start=104 data-line-end=105 ><a id="Rust_104"></a>Rustè¯­è¨€ä¹‹æ€ªç°è±¡</h5>
<ul>
<li class="has-line-data" data-line-start="106" data-line-end="108">å˜é‡ç¼ºçœä¸å¯è¢«ä¿®æ”¹ï¼Œä½†æ€»å¯ä»¥è¢«è¦†ç›–</li>
</ul>
<pre><code class="has-line-data" data-line-start="109" data-line-end="117" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span>;
<span class="hljs-keyword">let</span> x = x + <span class="hljs-number">1</span>;
{
    <span class="hljs-keyword">let</span> x = x * <span class="hljs-number">2</span>;
    <span class="hljs-comment">//x = 12</span>
}
<span class="hljs-comment">//x = 6</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="118" data-line-end="120">ä»£ç å—å…·æœ‰å€¼</li>
</ul>
<pre><code class="has-line-data" data-line-start="121" data-line-end="126" class="language-rust"><span class="hljs-keyword">let</span> y = {
    <span class="hljs-keyword">let</span> z = x * x;
    z / <span class="hljs-number">2</span>
}
</code></pre>
<h3 class="code-line" data-line-start=127 data-line-end=128 ><a id="02__127"></a>02 åŸºç¡€ç±»å‹</h3>
<h5 class="code-line" data-line-start=129 data-line-end=130 ><a id="_129"></a>æ•´æ•°ç±»å‹</h5>
<ul>
<li class="has-line-data" data-line-start="131" data-line-end="132">æ— ç¬¦å·æ•´æ•°ï¼šu8ï¼Œu16ï¼Œu32ï¼Œu64ï¼Œu128ï¼Œusizeï¼ˆå†…å­˜åœ°å€å®½åº¦ï¼‰</li>
<li class="has-line-data" data-line-start="132" data-line-end="134">æœ‰ç¬¦å·æ•´æ•°ï¼ši8ï¼Œi16ï¼Œi32ï¼Œi64ï¼Œi128ï¼Œisizeï¼ˆå†…å­˜åœ°å€å®½åº¦ï¼‰</li>
</ul>
<pre><code class="has-line-data" data-line-start="135" data-line-end="139" class="language-rust"><span class="hljs-number">123u8</span>, -<span class="hljs-number">1680isize</span>
<span class="hljs-number">0x0fffffi32</span>, -<span class="hljs-number">0o1670isize</span>, <span class="hljs-number">0b1100u8</span>
<span class="hljs-number">0x_0f_ffff_i32</span>, -<span class="hljs-number">0o_1_670_isize</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="140" data-line-end="142">
<p class="has-line-data" data-line-start="140" data-line-end="141">æ¨æ–­å‡ºå¤šç§å¯èƒ½ç±»å‹ï¼Œå¦‚æœi32æ˜¯å…¶ä¸­ä¸€ç§åˆ™ä¸ºi32ï¼Œå¦åˆ™ç¼–è¯‘å™¨æŠ¥é”™</p>
</li>
<li class="has-line-data" data-line-start="142" data-line-end="144">
<p class="has-line-data" data-line-start="142" data-line-end="143">ASCIIå­—ç¬¦å­—é¢é‡</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="145" data-line-end="149" class="language-rust">b<span class="hljs-string">'A'</span> <span class="hljs-comment">//=65u8</span>
b<span class="hljs-string">'\x41'</span> <span class="hljs-comment">//=65u8</span>
b<span class="hljs-string">'\''</span>, b<span class="hljs-string">'\\'</span>, b<span class="hljs-string">'\n'</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="150" data-line-end="152">asç±»å‹è½¬æ¢</li>
</ul>
<pre><code class="has-line-data" data-line-start="153" data-line-end="156" class="language-rust"><span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">1000_i16</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">u8</span>, <span class="hljs-number">232_u8</span>);
<span class="hljs-built_in">assert_eq!</span>(-<span class="hljs-number">10_i8</span> <span class="hljs-keyword">as</span> u16, <span class="hljs-number">65526_u16</span>); <span class="hljs-comment">//ç¬¦å·ä½é«˜ä½å¡«è¡¥</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="157" data-line-end="159">é™„ç€æ–¹æ³•</li>
</ul>
<pre><code class="has-line-data" data-line-start="160" data-line-end="169" class="language-rust"><span class="hljs-number">2_u16</span>.pow(<span class="hljs-number">4</span>)
u16::pow(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)

(-<span class="hljs-number">4_i32</span>).abs()
i32::abs(-<span class="hljs-number">4</span>)

<span class="hljs-number">0b1001_u8</span>.count_ones()
u8::count_ones(<span class="hljs-number">0b1001</span>)
</code></pre>
<ul>
<li class="has-line-data" data-line-start="170" data-line-end="172">å‡½æ•°è°ƒç”¨ä¼˜å…ˆçº§é«˜äºä¸€å…ƒå‰ç¼€æ“ä½œç¬¦ä¼˜å…ˆçº§</li>
</ul>
<pre><code class="has-line-data" data-line-start="173" data-line-end="176" class="language-rust"><span class="hljs-built_in">assert_eq!</span>((-<span class="hljs-number">4_i32</span>).abs(), <span class="hljs-number">4</span>);
<span class="hljs-built_in">assert_eq!</span>(-<span class="hljs-number">4_i32</span>.abs(), -<span class="hljs-number">4</span>);
</code></pre>
<h5 class="code-line" data-line-start=177 data-line-end=178 ><a id="_177"></a>æ•´æ•°è¿ç®—æº¢å‡º</h5>
<pre><code class="has-line-data" data-line-start="180" data-line-end="186" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> num = <span class="hljs-number">1</span>;
<span class="hljs-keyword">loop</span> {
    num *= <span class="hljs-number">2</span>;
}
<span class="hljs-comment">//debugæ¨¡å¼ä¸‹panic</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="187" data-line-end="189">checked operations</li>
</ul>
<pre><code class="has-line-data" data-line-start="190" data-line-end="195" class="language-rust"><span class="hljs-keyword">loop</span> {
    num = num.checked_mul(<span class="hljs-number">2</span>).expect(<span class="hljs-string">"overflowed"</span>);
}
<span class="hljs-comment">//dubugå’Œreleaseæ¨¡å¼ä¸‹</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="197" data-line-end="202" class="language-rust"><span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">10_u8</span>.checked_add(<span class="hljs-number">2</span>), <span class="hljs-built_in">Some</span>(<span class="hljs-number">30</span>));
<span class="hljs-built_in">assert_eq!</span>((-<span class="hljs-number">128_i8</span>).checked_div(-<span class="hljs-number">1</span>), <span class="hljs-built_in">None</span>);
<span class="hljs-comment">//None.expect("xxx")ï¼šå¯¼è‡´panicï¼Œè¾“å‡ºxxx</span>
<span class="hljs-comment">//Some(num).expect("xxx")ï¼šè¿”å›num</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="203" data-line-end="207">
<p class="has-line-data" data-line-start="203" data-line-end="204">wrapping operations</p>
<p class="has-line-data" data-line-start="205" data-line-end="206">ä¸releaseæ¨¡å¼ä¸‹çš„ç¼ºçœæº¢å‡ºè¡Œä¸ºå®Œå…¨ç›¸åŒ</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="208" data-line-end="210" class="language-rust"><span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">500_u16</span>.wrapping_mul(<span class="hljs-number">500</span>), <span class="hljs-number">53392</span>);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="211" data-line-end="215">
<p class="has-line-data" data-line-start="211" data-line-end="212">overflowing operations</p>
<p class="has-line-data" data-line-start="213" data-line-end="214">wrapping operationä¸‹çš„è®¡ç®—ç»“æœ</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="216" data-line-end="219" class="language-rust"><span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">255_u8</span>.overflowing_sub(<span class="hljs-number">2</span>), (<span class="hljs-number">253</span>, <span class="hljs-keyword">false</span>));
<span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">5_u16</span>.overflowing_shl(<span class="hljs-number">17</span>), (<span class="hljs-number">10</span>, <span class="hljs-keyword">true</span>)); <span class="hljs-comment">//17 % 16 = 1</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="220" data-line-end="226">
<p class="has-line-data" data-line-start="220" data-line-end="221">saturating operations</p>
<p class="has-line-data" data-line-start="222" data-line-end="223">ç±»å‹è¡¨ç¤ºèŒƒå›´å†…è·ç¦»ç»“æœæœ€è¿‘çš„å€¼</p>
<p class="has-line-data" data-line-start="224" data-line-end="225">é™¤ã€å–ä½™ã€ä½ç§»æ²¡æœ‰saturating operations</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="227" data-line-end="229" class="language-rust"><span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">32760_i16</span>.saturating_add(<span class="hljs-number">10</span>), <span class="hljs-number">32767</span>);
</code></pre>
<h5 class="code-line" data-line-start=230 data-line-end=231 ><a id="_230"></a>æµ®ç‚¹æ•°ç±»å‹</h5>
<ul>
<li class="has-line-data" data-line-start="232" data-line-end="233">f32ã€f64</li>
<li class="has-line-data" data-line-start="233" data-line-end="235">æ— æ³•æ¨æ–­åˆ™é»˜è®¤ä¸ºf64</li>
</ul>
<pre><code class="has-line-data" data-line-start="236" data-line-end="243" class="language-rust"><span class="hljs-number">31415.926e-4f64</span>
f64::MAX
f64::MIN
f64::INFINITY
f64::NEG_INFINITY
f64::NAN
</code></pre>
<pre><code class="has-line-data" data-line-start="245" data-line-end="248" class="language-rust"><span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, f64::NAN == f64::NAN); <span class="hljs-comment">//false</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, f64::is_nan(f64::NAN)); <span class="hljs-comment">//true</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="250" data-line-end="253" class="language-rust"><span class="hljs-keyword">let</span> a = <span class="hljs-number">0.0</span> / <span class="hljs-number">0.0</span>; <span class="hljs-comment">//NAN</span>
<span class="hljs-keyword">let</span> b = f64::sqrt(-<span class="hljs-number">1.0</span>); <span class="hljs-comment">//NAN </span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="254" data-line-end="256">å¸¸é‡</li>
</ul>
<pre><code class="has-line-data" data-line-start="257" data-line-end="262" class="language-rust"><span class="hljs-keyword">use</span> std::f64::consts::PI;

<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, PI);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:/20}"</span>, PI); <span class="hljs-comment">//20ä½ï¼Œä¸å¤Ÿåˆ™è¡¥0</span>
</code></pre>
<h5 class="code-line" data-line-start=263 data-line-end=264 ><a id="size_of_263"></a>å·¥å…·å‡½æ•°size_of</h5>
<pre><code class="has-line-data" data-line-start="266" data-line-end="268" class="language-rust"><span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, std::mem::size_of::&lt;isize&gt;());
</code></pre>
<h5 class="code-line" data-line-start=269 data-line-end=270 ><a id="_269"></a>å¸ƒå°”ç±»å‹</h5>
<ul>
<li class="has-line-data" data-line-start="271" data-line-end="272">1å­—èŠ‚</li>
<li class="has-line-data" data-line-start="272" data-line-end="274">asæ“ä½œç¬¦å¯å°†boolè½¬ä¸ºæ•´æ•°ï¼Œæ— æ³•å°†æ•°å­—è½¬ä¸ºbool</li>
</ul>
<pre><code class="has-line-data" data-line-start="275" data-line-end="279" class="language-rust"><span class="hljs-built_in">assert_eq!</span>(<span class="hljs-keyword">false</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">i32</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">assert_eq!</span>(<span class="hljs-keyword">true</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">f32</span>, <span class="hljs-number">1</span>); <span class="hljs-comment">//error</span>
<span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">bool</span>, <span class="hljs-keyword">true</span>); <span class="hljs-comment">//error</span>
</code></pre>
<h5 class="code-line" data-line-start=280 data-line-end=281 ><a id="_280"></a>å­—ç¬¦ç±»å‹</h5>
<ul>
<li class="has-line-data" data-line-start="282" data-line-end="284">
<p class="has-line-data" data-line-start="282" data-line-end="283">4å­—èŠ‚</p>
</li>
<li class="has-line-data" data-line-start="284" data-line-end="286">
<p class="has-line-data" data-line-start="284" data-line-end="285">å­—é¢é‡</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="287" data-line-end="290" class="language-rust"><span class="hljs-string">'\xHH'</span> <span class="hljs-comment">//ASCII</span>
'\u{HHHHHH}' <span class="hljs-comment">//Unicode</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="291" data-line-end="293">charè½¬æ¢ä¸ºæ•´æ•°</li>
</ul>
<pre><code class="has-line-data" data-line-start="294" data-line-end="296" class="language-rust"><span class="hljs-built_in">assert_eq!</span>('ğŸ‘' <span class="hljs-keyword">as</span> <span class="hljs-keyword">u32</span>, <span class="hljs-number">0x1f44d</span>);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="297" data-line-end="299">u8è½¬æ¢ä¸ºchar</li>
</ul>
<pre><code class="has-line-data" data-line-start="300" data-line-end="303" class="language-rust"><span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">97_u8</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">char</span>, <span class="hljs-string">'a'</span>);
<span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">97_u16</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">char</span>, <span class="hljs-string">'a'</span>); <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="304" data-line-end="306">u32è½¬æ¢ä¸ºchar</li>
</ul>
<pre><code class="has-line-data" data-line-start="307" data-line-end="312" class="language-rust"><span class="hljs-keyword">use</span> std::<span class="hljs-keyword">char</span>

<span class="hljs-built_in">assert_eq!</span>(char::from_u32(<span class="hljs-number">0x2764</span>), <span class="hljs-built_in">Some</span>(â¤));
<span class="hljs-built_in">assert_eq!</span>(char::from_u32(<span class="hljs-number">0x110000</span>), <span class="hljs-built_in">None</span>);
</code></pre>
<h5 class="code-line" data-line-start=313 data-line-end=314 ><a id="_313"></a>å…ƒç»„ç±»å‹</h5>
<pre><code class="has-line-data" data-line-start="316" data-line-end="324" class="language-rust"><span class="hljs-keyword">let</span> t = (<span class="hljs-number">1</span>, <span class="hljs-keyword">false</span>, <span class="hljs-number">0.1</span>); <span class="hljs-comment">//ç±»å‹æ¨æ–­</span>
<span class="hljs-keyword">let</span> t1: (<span class="hljs-keyword">i64</span>, <span class="hljs-keyword">bool</span>, <span class="hljs-keyword">f32</span>) = (t.<span class="hljs-number">1</span>, t.<span class="hljs-number">2</span>, t.<span class="hljs-number">3</span>);

<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, t);

<span class="hljs-keyword">let</span> i: usize = <span class="hljs-number">1</span>;
pritln!(<span class="hljs-string">"{}"</span>, t[i]); <span class="hljs-comment">//error</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="326" data-line-end="332" class="language-rust"><span class="hljs-keyword">let</span> t = (<span class="hljs-number">1</span>, <span class="hljs-keyword">false</span>, ); <span class="hljs-comment">//æœ€åä¸€ä¸ªå€¼åå¯æ·»åŠ é€—å·</span>

<span class="hljs-keyword">let</span> t1: (<span class="hljs-keyword">i32</span>, ) = (<span class="hljs-number">1</span> + <span class="hljs-number">1</span>, ); <span class="hljs-comment">//1å…ƒç»„æœ€åå¿…é¡»æ·»åŠ é€—å·</span>

<span class="hljs-keyword">let</span> t0: () = (); <span class="hljs-comment">//0å…ƒç»„ä¸èƒ½å‡ºç°é€—å·</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="333" data-line-end="335">ä½œä¸ºå‡½æ•°è¿”å›å€¼</li>
</ul>
<pre><code class="has-line-data" data-line-start="336" data-line-end="340" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(x: <span class="hljs-keyword">i32</span>, y: <span class="hljs-keyword">i32</span>) -&gt; (<span class="hljs-keyword">i32</span>, <span class="hljs-keyword">i32</span>) {}

<span class="hljs-keyword">let</span> (x, y) = f(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="342" data-line-end="344" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(x : <span class="hljs-keyword">i32</span>) {} <span class="hljs-comment">//å®é™…è¿”å›0-tuple</span>
</code></pre>
<h5 class="code-line" data-line-start=345 data-line-end=346 ><a id="_345"></a>æŒ‡é’ˆç±»å‹</h5>
<ul>
<li class="has-line-data" data-line-start="347" data-line-end="349">å¼•ç”¨ï¼ˆReferenceï¼‰</li>
</ul>
<pre><code class="has-line-data" data-line-start="350" data-line-end="360" class="language-rust"><span class="hljs-keyword">let</span> v: <span class="hljs-keyword">i32</span> = <span class="hljs-number">123</span>;
<span class="hljs-keyword">let</span> r = &amp;v;
<span class="hljs-keyword">let</span> r1: &amp;<span class="hljs-keyword">i32</span> = &amp;v;

<span class="hljs-keyword">let</span> v1: <span class="hljs-keyword">i32</span> = *r; <span class="hljs-comment">//å»å¼•ç”¨ï¼ˆdereferenceï¼‰</span>
*r = <span class="hljs-number">456</span>; <span class="hljs-comment">//errorï¼Œåªè¯»</span>

<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:p}"</span>, r); <span class="hljs-comment">//åœ°å€</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r); <span class="hljs-comment">//123</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="362" data-line-end="366" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> v: <span class="hljs-keyword">i32</span> = <span class="hljs-number">123</span>;
<span class="hljs-keyword">let</span> r = &amp;<span class="hljs-keyword">mut</span> v;
*r = <span class="hljs-number">456</span>;
</code></pre>
<ul>
<li class="has-line-data" data-line-start="367" data-line-end="371">
<p class="has-line-data" data-line-start="367" data-line-end="368">Box</p>
<p class="has-line-data" data-line-start="369" data-line-end="370">å€¼å­˜åœ¨å †ä¸­</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="372" data-line-end="377" class="language-rust"><span class="hljs-keyword">let</span> v = <span class="hljs-number">123</span>;
<span class="hljs-keyword">let</span> b = Box::new(v);
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> b1: <span class="hljs-built_in">Box</span>&lt;<span class="hljs-keyword">i32</span>&gt; = Box::new(v);
*b1 = <span class="hljs-number">456</span>;
</code></pre>
<ul>
<li class="has-line-data" data-line-start="378" data-line-end="380">raw pointer</li>
</ul>
<pre><code class="has-line-data" data-line-start="381" data-line-end="390" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> ptr_x = &amp;<span class="hljs-keyword">mut</span> x <span class="hljs-keyword">as</span> *<span class="hljs-keyword">mut</span> <span class="hljs-keyword">i32</span>;
<span class="hljs-keyword">let</span> y = Box::new(<span class="hljs-number">20</span>);
<span class="hljs-keyword">let</span> ptr_y = &amp;*y <span class="hljs-keyword">as</span> *<span class="hljs-keyword">const</span> <span class="hljs-keyword">i32</span>;

<span class="hljs-keyword">unsafe</span> {
    *ptr_x += *ptr_y;
}
</code></pre>
<h5 class="code-line" data-line-start=391 data-line-end=392 ><a id="_391"></a>æ•°ç»„ã€å‘é‡ã€åˆ‡ç‰‡</h5>
<ul>
<li class="has-line-data" data-line-start="393" data-line-end="397">
<p class="has-line-data" data-line-start="393" data-line-end="394">array æ•°ç»„</p>
<p class="has-line-data" data-line-start="395" data-line-end="396">ç¼ºçœè¢«æ”¾ç½®åœ¨æ ˆä¸­</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="398" data-line-end="402" class="language-rust"><span class="hljs-keyword">let</span> a: [<span class="hljs-keyword">u32</span>; <span class="hljs-number">5</span>] = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];
<span class="hljs-keyword">let</span> b = [<span class="hljs-keyword">true</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">true</span>];
<span class="hljs-keyword">let</span> c = [<span class="hljs-number">0</span>; <span class="hljs-number">100</span>];
</code></pre>
<ul>
<li class="has-line-data" data-line-start="403" data-line-end="407">
<p class="has-line-data" data-line-start="403" data-line-end="404">vector å‘é‡</p>
<p class="has-line-data" data-line-start="405" data-line-end="406">è‡ªèº«åœ¨æ ˆä¸­ï¼Œå…ƒç´ åœ¨å †ä¸­</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="408" data-line-end="414" class="language-rust"><span class="hljs-keyword">let</span> v: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt; = <span class="hljs-built_in">vec!</span>[];
<span class="hljs-keyword">let</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>; <span class="hljs-number">10</span>];
v.insert(<span class="hljs-number">3</span>, <span class="hljs-number">10</span>);
v.remove(<span class="hljs-number">1</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="416" data-line-end="423" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> vec: <span class="hljs-built_in">Vec</span>&lt;u16&gt; = Vec::with_capacity(<span class="hljs-number">10</span>);
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..<span class="hljs-number">10</span> {
    vec.push(i);
}
vec.push(<span class="hljs-number">10</span>); 
<span class="hljs-built_in">assert!</span>(vec.capacity() &gt;= <span class="hljs-number">11</span>); <span class="hljs-comment">//å†…å­˜é‡åˆ†é…</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="425" data-line-end="430" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> v = <span class="hljs-built_in">vec!</span>[];
v.push(<span class="hljs-number">1</span>);
<span class="hljs-built_in">assert_eq!</span>(v.pop(), <span class="hljs-built_in">Some</span>(<span class="hljs-number">1</span>));
<span class="hljs-built_in">assert_eq!</span>(v.pop(), <span class="hljs-built_in">None</span>);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="431" data-line-end="433">slice åˆ‡ç‰‡</li>
</ul>
<pre><code class="has-line-data" data-line-start="434" data-line-end="443" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> a = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> s = &amp;a[<span class="hljs-number">0</span>..<span class="hljs-number">2</span>]; <span class="hljs-comment">//[0, 2)</span>

<span class="hljs-keyword">let</span> s = &amp;a; <span class="hljs-comment">//ä¸æ˜¯åˆ‡ç‰‡</span>
<span class="hljs-keyword">let</span> s: &amp;[u16] = &amp;a; <span class="hljs-comment">//æ˜¯åˆ‡ç‰‡</span>
<span class="hljs-keyword">let</span> s = &amp;a[..];
<span class="hljs-keyword">let</span> s = &amp;a[<span class="hljs-number">1</span>..];
<span class="hljs-keyword">let</span> s = &amp;a[..<span class="hljs-number">3</span>];
</code></pre>
<pre><code class="has-line-data" data-line-start="445" data-line-end="452" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(s: &amp;[u16]) {}

<span class="hljs-keyword">let</span> a = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>];
<span class="hljs-keyword">let</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>];
f(&amp;a);
f(&amp;v);
</code></pre>
<pre><code class="has-line-data" data-line-start="454" data-line-end="458" class="language-rust"><span class="hljs-comment">//sliceä¸Šé™„ç€çš„æ‰€æœ‰æ–¹æ³•éƒ½é€‚ç”¨äºarrayå’Œvector</span>
v.sort();
v.reverse();
</code></pre>
<h5 class="code-line" data-line-start=459 data-line-end=460 ><a id="_459"></a>å­—ç¬¦ä¸²ç±»å‹</h5>
<pre><code class="has-line-data" data-line-start="462" data-line-end="475" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() {
    <span class="hljs-keyword">let</span> s = <span class="hljs-string">"\"hello world\""</span>;
    
    <span class="hljs-keyword">let</span> s = <span class="hljs-string">"hello
    world"</span>; <span class="hljs-comment">//åŒ…å«æ¯ä¸€è¡Œå‰é¢ç©ºæ ¼</span>
    
    <span class="hljs-keyword">let</span> s = <span class="hljs-string">"hello\
    world"</span>; <span class="hljs-comment">//ä¸€è¡Œ</span>
    
    <span class="hljs-keyword">let</span> s = <span class="hljs-string">r"\"</span>; <span class="hljs-comment">//åœæ­¢è½¬ä¹‰æ“ä½œï¼Œæ— æ³•æ”¾ç½®"å­—ç¬¦</span>
    <span class="hljs-keyword">let</span> s = <span class="hljs-string">r##"\"##</span>; <span class="hljs-comment">//å¯ä»¥æ”¾ç½®"å­—ç¬¦</span>
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="476" data-line-end="477">å†…å­˜ä¸­é‡‡ç”¨UTF-8ç¼–ç ï¼Œä¸åŒå­—ç¬¦ç¼–ç é•¿åº¦å¯èƒ½ä¸åŒ</li>
<li class="has-line-data" data-line-start="477" data-line-end="479">ä¸¤ç§ç±»å‹å­—ç¬¦ä¸²ï¼šStringï¼ˆç‰¹æ®Šçš„Vec&lt;u8&gt;ï¼‰ã€&amp;strï¼ˆç‰¹æ®Šçš„&amp;[u8]ï¼‰</li>
</ul>
<pre><code class="has-line-data" data-line-start="480" data-line-end="486" class="language-rust"><span class="hljs-keyword">let</span> v = <span class="hljs-string">"hello"</span>.to_string();
<span class="hljs-keyword">let</span> v = String::from(<span class="hljs-string">"world"</span>);

<span class="hljs-keyword">let</span> s = &amp;v[<span class="hljs-number">1</span>..<span class="hljs-number">4</span>];
<span class="hljs-keyword">let</span> l = <span class="hljs-string">"hello world"</span>; <span class="hljs-comment">//ç±»å‹&amp;strï¼Œæ‰€å¼•ç”¨å­—ç¬¦ä¸²åœ¨å†…å­˜çš„åªè¯»åŒºåŸŸä¸­</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="488" data-line-end="491" class="language-rust"><span class="hljs-keyword">let</span> s = <span class="hljs-built_in">format!</span>(<span class="hljs-string">"hello {}"</span>, <span class="hljs-string">"world"</span>);
<span class="hljs-keyword">let</span> s = <span class="hljs-built_in">format!</span>(<span class="hljs-string">"x = {x}"</span>, x = <span class="hljs-number">1</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="493" data-line-end="499" class="language-rust"><span class="hljs-built_in">assert_eq!</span>([<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>].concat(), <span class="hljs-string">"helloworld"</span>);
<span class="hljs-built_in">assert_eq!</span>([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]].concat(), [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);
<span class="hljs-built_in">assert_eq!</span>([<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>].join(<span class="hljs-string">" "</span>), <span class="hljs-string">"hello world"</span>);
<span class="hljs-built_in">assert_eq!</span>([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]].join(&amp;<span class="hljs-number">0</span>), [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);
<span class="hljs-built_in">assert_eq!</span>([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]].join(&amp;[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>][..]), [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);
</code></pre>
<pre><code class="has-line-data" data-line-start="501" data-line-end="506" class="language-rust"><span class="hljs-built_in">assert_eq!</span>(<span class="hljs-string">"ä¸­æ–‡"</span>.len, <span class="hljs-number">6</span>);
<span class="hljs-built_in">assert_eq!</span>(<span class="hljs-string">"ä¸­æ–‡"</span>.chars().count(), <span class="hljs-number">2</span>);
<span class="hljs-built_in">assert_eq!</span>(<span class="hljs-string">"English"</span>.len(), <span class="hljs-number">7</span>);
<span class="hljs-built_in">assert_eq!</span>(<span class="hljs-string">"English"</span>.chars().count(), <span class="hljs-number">7</span>);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="507" data-line-end="509">mutable String</li>
</ul>
<pre><code class="has-line-data" data-line-start="510" data-line-end="516" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s = String::from(<span class="hljs-string">"hello"</span>);
s.push(<span class="hljs-string">' '</span>);
s.push_str(<span class="hljs-string">"world"</span>);
s.insert(<span class="hljs-number">5</span>, <span class="hljs-string">' '</span>);
s.insert_str(<span class="hljs-number">11</span>, <span class="hljs-string">"!!"</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="518" data-line-end="522" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s = String::from(<span class="hljs-string">"ä¸­æ–‡"</span>)ï¼›
s.push(<span class="hljs-string">'ä¸²'</span>)ï¼›
s.insert(<span class="hljs-number">1</span>, <span class="hljs-string">'E'</span>); <span class="hljs-comment">//error</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="524" data-line-end="527" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> z = String::from(<span class="hljs-string">"English"</span>);
z[<span class="hljs-number">0</span>] = <span class="hljs-string">'e'</span>; <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="528" data-line-end="530">mutable &amp;str</li>
</ul>
<pre><code class="has-line-data" data-line-start="531" data-line-end="535" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> z = String::from(<span class="hljs-string">"English"</span>);
<span class="hljs-keyword">let</span> s = &amp;<span class="hljs-keyword">mut</span> z[<span class="hljs-number">0</span>..<span class="hljs-number">3</span>];
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, s.make_ascii_lowercase());
</code></pre>
<ul>
<li class="has-line-data" data-line-start="536" data-line-end="538">æ¯”è¾ƒæ“ä½œç¬¦</li>
</ul>
<pre><code class="has-line-data" data-line-start="539" data-line-end="543" class="language-rust"><span class="hljs-keyword">let</span> a = <span class="hljs-string">"Dog"</span>.to_lowecase() == <span class="hljs-string">"dog"</span>; <span class="hljs-comment">//true</span>
<span class="hljs-keyword">let</span> a = <span class="hljs-string">"Dog"</span> != <span class="hljs-string">"dog"</span>; <span class="hljs-comment">//true</span>
<span class="hljs-keyword">let</span> a = <span class="hljs-string">"Dog"</span> &gt; <span class="hljs-string">"dog"</span>; <span class="hljs-comment">//false</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="545" data-line-end="549" class="language-rust"><span class="hljs-keyword">let</span> s0 = <span class="hljs-string">"th\u{e9}"</span>; <span class="hljs-comment">//thÃ©</span>
<span class="hljs-keyword">let</span> s1 = <span class="hljs-string">"the\u{301}"</span>; <span class="hljs-comment">//theÌ</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, s0 == s1); <span class="hljs-comment">//false</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="550" data-line-end="554">
<p class="has-line-data" data-line-start="550" data-line-end="551">å…¶ä»–å¸¸ç”¨æ–¹æ³•</p>
<p class="has-line-data" data-line-start="552" data-line-end="553">å½“åœ¨Stringä¸Šè°ƒç”¨&amp;strä¸Šçš„æ–¹æ³•æ—¶ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æŠŠStringè½¬æ¢ä¸º&amp;str</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="555" data-line-end="564" class="language-rust"><span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, <span class="hljs-string">"Hello, world!"</span>.contains(<span class="hljs-string">"world"</span>)); <span class="hljs-comment">//true</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, <span class="hljs-string">"Hello, world!"</span>.replace(<span class="hljs-string">"world"</span>, <span class="hljs-string">"dog"</span>)); <span class="hljs-comment">//Hello, dog!</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, <span class="hljs-string">" Hello  \n  "</span>.trim() = <span class="hljs-string">"Hello"</span>); <span class="hljs-comment">//true</span>

<span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> <span class="hljs-string">"Hello world and dog"</span>.split(<span class="hljs-string">""</span>) {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, word);
}

</code></pre>
<ul>
<li class="has-line-data" data-line-start="565" data-line-end="573">
<p class="has-line-data" data-line-start="565" data-line-end="566">Byte String</p>
<p class="has-line-data" data-line-start="567" data-line-end="568">æœ¬è´¨æ˜¯[u8; N]</p>
<p class="has-line-data" data-line-start="569" data-line-end="570">String literalçš„å„ç§è¯­æ³•éƒ½é€‚ç”¨äºByte Stringï¼ˆRaw Byte Stringçš„å‰ç¼€çš„brï¼‰</p>
<p class="has-line-data" data-line-start="571" data-line-end="572">Stringå’Œ&amp;strä¸Šçš„æ–¹æ³•ä¸é€‚ç”¨äºByte String</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="574" data-line-end="577" class="language-rust"><span class="hljs-keyword">let</span> s = b<span class="hljs-string">"GET"</span>;
<span class="hljs-built_in">assert_eq!</span>(s, &amp;[b<span class="hljs-string">'G'</span>, b<span class="hljs-string">'E'</span>, b<span class="hljs-string">'T'</span>]);
</code></pre>
<h5 class="code-line" data-line-start=578 data-line-end=579 ><a id="_578"></a>ç±»å‹åˆ«å</h5>
<pre><code class="has-line-data" data-line-start="581" data-line-end="584" class="language-rust"><span class="hljs-keyword">type</span> <span class="hljs-title">Bytes</span> = <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;;
<span class="hljs-keyword">let</span> a: Bytes = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>];
</code></pre>
<h5 class="code-line" data-line-start=585 data-line-end=586 ><a id="_585"></a>ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹</h5>
<ul>
<li class="has-line-data" data-line-start="587" data-line-end="589">struct</li>
</ul>
<pre><code class="has-line-data" data-line-start="590" data-line-end="613" class="language-rust"><span class="hljs-keyword">struct</span> Image {
    size: (usize, usize),
    pixels: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u32</span>&gt;
}
<span class="hljs-keyword">impl</span> Image {
    <span class="hljs-comment">//type-associated function</span>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">new</span></span>(w: usize, h: usize) -&gt; Image {
        Image {
            pixels: <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>; w * h];
            size: (w, h);
        }
    }
    <span class="hljs-comment">//value-associated function</span>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">sizes</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; (usize, usize) {
        <span class="hljs-keyword">self</span>.size
    }
}

<span class="hljs-keyword">let</span> image = Image {
    pixels: <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>; width * height],
    size: (width, height)
};
</code></pre>
<ul>
<li class="has-line-data" data-line-start="614" data-line-end="616">enum</li>
</ul>
<pre><code class="has-line-data" data-line-start="617" data-line-end="645" class="language-rust"><span class="hljs-preprocessor">#[derive(PartialEq)]</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title">Ordering</span> {
    Less,
    Equal,
    Greater
}
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">cmp</span></span>(a: <span class="hljs-keyword">i32</span>, b: <span class="hljs-keyword">i32</span>) -&gt; Ordering {
    <span class="hljs-keyword">if</span> a &lt; b {
        Ordering::Less
    } 
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> a &gt; b {
        Ordering::Greater
    } 
    <span class="hljs-keyword">else</span> {
        Ordering::Equal
    }
}
<span class="hljs-keyword">impl</span> Ordering {
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_eq</span></span>(<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-keyword">bool</span> {
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span> == Ordering::Equal {
            <span class="hljs-keyword">true</span>
        } 
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">false</span>
        }
    }
}
</code></pre>
<pre><code class="has-line-data" data-line-start="647" data-line-end="667" class="language-rust"><span class="hljs-preprocessor">#[derive(PartialEq)]</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title">Color</span> {
    RGB(<span class="hljs-keyword">u8</span>, <span class="hljs-keyword">u8</span>, <span class="hljs-keyword">u8</span>),
    Gray(<span class="hljs-keyword">u8</span>)
}
<span class="hljs-keyword">impl</span> Color {
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_gray</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-keyword">bool</span> {
        <span class="hljs-keyword">match</span> <span class="hljs-keyword">self</span> {
            Color::Gray(_) =&gt; <span class="hljs-keyword">true</span>,
            Color::RGB(a, b, c) =&gt;
                <span class="hljs-keyword">if</span> a == b &amp;&amp; b == c {
                    <span class="hljs-keyword">true</span>
                } 
                <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">false</span>    
                }
        }
    }
}
</code></pre>
<pre><code class="has-line-data" data-line-start="669" data-line-end="683" class="language-rust"><span class="hljs-comment">//std::option::Option</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title">Option</span>&lt;T&gt; {
    <span class="hljs-built_in">None</span>,
    <span class="hljs-built_in">Some</span>(T),
}
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">divide</span></span>(x: <span class="hljs-keyword">f64</span>, y: <span class="hljs-keyword">f64</span>) -&gt; <span class="hljs-built_in">Option</span>&lt;<span class="hljs-keyword">f64</span>&gt; {
    <span class="hljs-keyword">if</span> y == <span class="hljs-number">0.0</span> {
        <span class="hljs-built_in">None</span>
    } 
    <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">Some</span>(x / y)
    }
}
</code></pre>
<h5 class="code-line" data-line-start=684 data-line-end=685 ><a id="RustMemory_684"></a>Rustå…³äºMemoryçš„è‹¥å¹²åŸºæœ¬æ¦‚å¿µ</h5>
<ul>
<li class="has-line-data" data-line-start="686" data-line-end="692">
<p class="has-line-data" data-line-start="686" data-line-end="687">Value</p>
<p class="has-line-data" data-line-start="688" data-line-end="689">Type + Byte Representation</p>
<p class="has-line-data" data-line-start="690" data-line-end="691">Independent of where the value is stored</p>
</li>
<li class="has-line-data" data-line-start="692" data-line-end="698">
<p class="has-line-data" data-line-start="692" data-line-end="693">Place</p>
<p class="has-line-data" data-line-start="694" data-line-end="695">A location in memory that can hold a value</p>
<p class="has-line-data" data-line-start="696" data-line-end="697">can be on stack, the heap, â€¦</p>
</li>
<li class="has-line-data" data-line-start="698" data-line-end="704">
<p class="has-line-data" data-line-start="698" data-line-end="699">Variable</p>
<p class="has-line-data" data-line-start="700" data-line-end="701">A place on the stack</p>
<p class="has-line-data" data-line-start="702" data-line-end="703">a named value slot on the stack</p>
</li>
<li class="has-line-data" data-line-start="704" data-line-end="710">
<p class="has-line-data" data-line-start="704" data-line-end="705">Pointer</p>
<p class="has-line-data" data-line-start="706" data-line-end="707">A value that holds the address of a place</p>
<p class="has-line-data" data-line-start="708" data-line-end="709">That is, a pointer points to a place</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="711" data-line-end="721" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span>;
<span class="hljs-keyword">let</span> v = &amp;x;
<span class="hljs-comment">//Value: 5k, &amp;x</span>
<span class="hljs-comment">//Place: x, v</span>
<span class="hljs-comment">//Variable: x, v</span>
<span class="hljs-comment">//Pointer: &amp;x</span>

<span class="hljs-comment">//let x = vec![0, 1, 2];</span>
<span class="hljs-comment">//let y = &amp;x[1..3];</span>
</code></pre>
<h3 class="code-line" data-line-start=724 data-line-end=725 ><a id="03__724"></a>03 æ‰€æœ‰æƒä¸æ‰€æœ‰æƒè½¬ç§»</h3>
<h5 class="code-line" data-line-start=726 data-line-end=727 ><a id="_726"></a>ç¤ºä¾‹</h5>
<ul>
<li class="has-line-data" data-line-start="728" data-line-end="730">C++</li>
</ul>
<pre><code class="has-line-data" data-line-start="731" data-line-end="739" class="language-cpp"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *ptr;
{
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> s = <span class="hljs-string">"Hello world"</span>;
    ptr = &amp;s;
}
<span class="hljs-comment">//æ— æ³•è®¿é—®å˜é‡s</span>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; *ptr; <span class="hljs-comment">//å¯ä»¥è®¿é—®åˆ°såŸæœ¬ç©ºé—´</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="740" data-line-end="742">Rust</li>
</ul>
<pre><code class="has-line-data" data-line-start="743" data-line-end="751" class="language-rust"><span class="hljs-keyword">let</span> ptr: &amp;<span class="hljs-built_in">String</span>;
{
    <span class="hljs-keyword">let</span> s = String::from(<span class="hljs-string">"Hello world"</span>);
    ptr = &amp;s; <span class="hljs-comment">//error</span>
}
<span class="hljs-comment">//æ— æ³•è®¿é—®å˜é‡s</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, ptr);
</code></pre>
<h5 class="code-line" data-line-start=752 data-line-end=753 ><a id="Rust_752"></a>Rustä¸­çš„æ‰€æœ‰æƒ</h5>
<ul>
<li class="has-line-data" data-line-start="754" data-line-end="762">
<p class="has-line-data" data-line-start="754" data-line-end="755">åœ¨ä»»æ„æ—¶åˆ»</p>
<p class="has-line-data" data-line-start="756" data-line-end="757">1ã€ä¸€ä¸ªå€¼å…·æœ‰å”¯ä¸€ä¸€ä¸ªæ‰€æœ‰è€…</p>
<p class="has-line-data" data-line-start="758" data-line-end="759">2ã€æ¯ä¸€ä¸ªå˜é‡ï¼Œä½œä¸ºæ ¹èŠ‚ç‚¹ï¼Œå‡ºç°åœ¨ä¸€æ£µæ‰€æœ‰æƒå…³ç³»æ ‘ä¸­</p>
<p class="has-line-data" data-line-start="760" data-line-end="761">3ã€å½“ä¸€ä¸ªå˜é‡ç¦»å¼€å½“å‰ä½œç”¨åŸŸåï¼Œå®ƒæ‰€æœ‰æƒå…³ç³»æ ‘ä¸­çš„æ‰€æœ‰å€¼éƒ½æ— æ³•å†è¢«è®¿é—®ï¼Œå…¶ä¸­æ‰€æœ‰å­˜åœ¨å †ä¸­çš„å€¼æ‰€å ç©ºé—´ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾</p>
</li>
<li class="has-line-data" data-line-start="762" data-line-end="772">
<p class="has-line-data" data-line-start="762" data-line-end="763">æ‰©å±•/è½¯åŒ–æªæ–½</p>
<p class="has-line-data" data-line-start="764" data-line-end="765">1ã€æ‰€æœ‰æƒè½¬ç§»</p>
<p class="has-line-data" data-line-start="766" data-line-end="767">2ã€ç®€å•å˜é‡è±å…</p>
<p class="has-line-data" data-line-start="768" data-line-end="769">3ã€å¼•ç”¨è®¡æ•°æŒ‡é’ˆç±»å‹</p>
<p class="has-line-data" data-line-start="770" data-line-end="771">4ã€borrow a ref to a value</p>
</li>
</ul>
<h5 class="code-line" data-line-start=772 data-line-end=773 ><a id="_772"></a>æ‰€æœ‰æƒè½¬ç§»</h5>
<ul>
<li class="has-line-data" data-line-start="774" data-line-end="782">
<p class="has-line-data" data-line-start="774" data-line-end="775">å¯¹no-copy typeçš„å€¼ï¼Œå‘ç”Ÿå¦‚ä¸‹æ“ä½œæ—¶</p>
<p class="has-line-data" data-line-start="776" data-line-end="777">1ã€èµ‹ç»™ä¸€ä¸ªå˜é‡</p>
<p class="has-line-data" data-line-start="778" data-line-end="779">2ã€ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°è°ƒç”¨</p>
<p class="has-line-data" data-line-start="780" data-line-end="781">3ã€åœ¨å‡½æ•°è°ƒç”¨ä¸­è¿”å›</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="783" data-line-end="787" class="language-rust"><span class="hljs-keyword">let</span> s = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> t = s; <span class="hljs-comment">//sæ ˆç©ºé—´çš„å€¼æ‹·è´åˆ°tçš„æ ˆç©ºé—´</span>
<span class="hljs-keyword">let</span> u = s; <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="788" data-line-end="794">
<p class="has-line-data" data-line-start="788" data-line-end="789">Pythonï¼šèµ‹å€¼æˆæœ¬ä½ï¼ˆå¢åŠ å¼•ç”¨è®¡æ•°ï¼‰ï¼Œå†…å­˜ç®¡ç†æˆæœ¬é«˜ï¼ˆè¿è¡Œæ—¶åƒåœ¾å›æ”¶ã€å¾ªç¯å¼•ç”¨éš¾å¤„ç†ï¼‰</p>
<p class="has-line-data" data-line-start="790" data-line-end="791">C++ï¼šèµ‹å€¼æˆæœ¬é«˜ï¼ˆæ·±å±‚å¤åˆ¶ï¼‰ï¼Œå†…å­˜ç®¡ç†æˆæœ¬ä½</p>
<p class="has-line-data" data-line-start="792" data-line-end="793">Rustï¼šèµ‹å€¼æˆæœ¬ä½ï¼ˆè¿‘æ‹·è´æ ˆç©ºé—´ï¼‰ï¼Œå†…å­˜ç®¡ç†æˆæœ¬ä½</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="795" data-line-end="798" class="language-rust"><span class="hljs-keyword">let</span> s = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> t = s.clone(); <span class="hljs-comment">//å®ç°C++èµ‹å€¼è¡Œä¸º</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="800" data-line-end="803" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s = String::from(<span class="hljs-string">"abc"</span>);
s = String::from(<span class="hljs-string">"def"</span>); <span class="hljs-comment">//åŸæ¥å †ç©ºé—´é‡Šæ”¾</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="804" data-line-end="808">
<p class="has-line-data" data-line-start="804" data-line-end="805">æ¡ä»¶è¯­å¥</p>
<p class="has-line-data" data-line-start="806" data-line-end="807">è‹¥å˜é‡æœ‰å¯èƒ½åœ¨æŸä¸€ä¸ªåˆ†æ”¯è¢«å‰¥å¤ºæ‰€æœ‰æƒï¼Œå³ä½¿è¿è¡Œæ²¡ç»è¿‡è¯¥åˆ†æ”¯ä¹Ÿä¸èƒ½è¯»è¯¥å˜é‡</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="809" data-line-end="816" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> c = <span class="hljs-number">1</span>;
<span class="hljs-keyword">if</span> c &lt; <span class="hljs-number">0</span> {
    f(x);
} 
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, x); <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="817" data-line-end="819">å¾ªç¯è¯­å¥</li>
</ul>
<pre><code class="has-line-data" data-line-start="820" data-line-end="827" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> len = x.len();
<span class="hljs-keyword">while</span> len &gt; <span class="hljs-number">0</span> {
    f(x); <span class="hljs-comment">//error</span>
    len -= <span class="hljs-number">1</span>;
}
</code></pre>
<pre><code class="has-line-data" data-line-start="829" data-line-end="837" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> x = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> len = x.len();
<span class="hljs-keyword">while</span> len &gt; <span class="hljs-number">0</span> {
    f(x);
    x = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
    len -= <span class="hljs-number">1</span>;
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="838" data-line-end="844">
<p class="has-line-data" data-line-start="838" data-line-end="839">æ•°ç»„ã€å‘é‡ã€åˆ‡ç‰‡</p>
<p class="has-line-data" data-line-start="840" data-line-end="841">ä¸å…è®¸ä»…é€šè¿‡èµ‹å€¼æŠŠæŸä½ç½®ä¸Šå…ƒç´ çš„æ‰€æœ‰æƒè½¬ç§»</p>
<p class="has-line-data" data-line-start="842" data-line-end="843">å¤šæ•°æƒ…å†µä¸å¿…è½¬ç§»æ‰€æœ‰æƒï¼Œå–å¾—å…ƒç´ çš„å¼•ç”¨å¯èƒ½å°±è¶³å¤Ÿ</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="845" data-line-end="848" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> v = <span class="hljs-built_in">vec!</span>[String::from(<span class="hljs-string">"abc"</span>), String::from(<span class="hljs-string">"def"</span>), String::from(<span class="hljs-string">"ghi"</span>), String::from(<span class="hljs-string">"jkl"</span>)];
<span class="hljs-keyword">let</span> x = v[<span class="hljs-number">1</span>]; <span class="hljs-comment">//error</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="850" data-line-end="854" class="language-rust"><span class="hljs-comment">//ä»å‘é‡ä¸­ï¼Œæˆæœ¬é«˜</span>
<span class="hljs-keyword">let</span> e = v.remove(<span class="hljs-number">1</span>);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, v); <span class="hljs-comment">//["abc", "ghi", "jkl"]</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="856" data-line-end="860" class="language-rust"><span class="hljs-comment">//ä»å‘é‡ä¸­</span>
<span class="hljs-keyword">let</span> e = v.swap_remove(<span class="hljs-number">1</span>);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, v); <span class="hljs-comment">//["abc", "jkl", "ghi"]</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="862" data-line-end="866" class="language-rust"><span class="hljs-comment">//ä»å‘é‡ä¸­</span>
<span class="hljs-keyword">let</span> e = v.pop().expect(<span class="hljs-string">"empty"</span>);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, v); <span class="hljs-comment">//["abc", "def", "ghi"]</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="868" data-line-end="872" class="language-rust"><span class="hljs-comment">//ä»å‘é‡/æ•°ç»„/åˆ‡ç‰‡ä¸­</span>
<span class="hljs-keyword">let</span> e = std::mem::replace(&amp;<span class="hljs-keyword">mut</span> v[<span class="hljs-number">1</span>], String::from(<span class="hljs-string">"dog"</span>));
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, v); <span class="hljs-comment">//["abc", "dog", "ghi", "jkl"]</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="874" data-line-end="878" class="language-rust"><span class="hljs-comment">//å¿…é¡»æ˜¯å…·æœ‰ç¼ºçœå€¼çš„ç±»å‹</span>
<span class="hljs-keyword">let</span> e = std::mem::take(&amp;<span class="hljs-keyword">mut</span> v[<span class="hljs-number">1</span>]);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, v); <span class="hljs-comment">//["abc", "", "ghi", "jkl"];</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="880" data-line-end="886" class="language-rust"><span class="hljs-comment">//æ˜¾ç¤ºæ ‡æ³¨æ˜¯å¦æœ‰å€¼</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-built_in">Some</span>(String::from(<span class="hljs-string">"abc"</span>)), <span class="hljs-built_in">Some</span>(String::from(<span class="hljs-string">"def"</span>))];
<span class="hljs-keyword">let</span> e = std::mem::take(&amp;<span class="hljs-keyword">mut</span> v[<span class="hljs-number">1</span>]);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, v); <span class="hljs-comment">//[Some("abc"), None]</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, e); <span class="hljs-comment">//Some("def")</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="887" data-line-end="889">å‘é‡/æ•°ç»„çš„æ‰€æœ‰æƒè½¬ç§»ç»™å¾ªç¯è¯­å¥</li>
</ul>
<pre><code class="has-line-data" data-line-start="890" data-line-end="896" class="language-rust"><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> v {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, s);
    <span class="hljs-comment">//ä¸èƒ½è¯»å–v</span>
}
<span class="hljs-comment">//ä¸èƒ½è¯»å–v</span>
</code></pre>
<h5 class="code-line" data-line-start=897 data-line-end=898 ><a id="Copy_Types_897"></a>Copy Types</h5>
<ul>
<li class="has-line-data" data-line-start="899" data-line-end="900">è¯­è¨€è‡ªå¸¦çš„æ‰€æœ‰æ•°å­—ç±»å‹ï¼ˆæ•´æ•°ã€æµ®ç‚¹æ•°ï¼‰ï¼Œchar/boolï¼Œè‹¥å¹²å…¶ä»–ç±»å‹ï¼Œå…ƒç´ ç±»å‹ä¸ºCopy Typeçš„æ•°ç»„ï¼Œæ‰€æœ‰å…ƒç´ ç±»å‹å‡ä¸ºCopy Typeçš„å…ƒç»„</li>
<li class="has-line-data" data-line-start="900" data-line-end="902">ç”¨æˆ·è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ç¼ºçœæƒ…å†µä¸‹éƒ½ä¸æ˜¯Copy Type</li>
</ul>
<pre><code class="has-line-data" data-line-start="903" data-line-end="906" class="language-rust"><span class="hljs-keyword">let</span> n1 = <span class="hljs-number">5</span>;
<span class="hljs-keyword">let</span> n2 = n1; <span class="hljs-comment">//æ ˆä¸­æ–°çš„ç©ºé—´</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="907" data-line-end="911">
<p class="has-line-data" data-line-start="907" data-line-end="908">Copy Typesä¸è‡ªå®šä¹‰æ•°æ®ç±»å‹</p>
<p class="has-line-data" data-line-start="909" data-line-end="910">å¦‚æœstructç±»å‹åŒ…å«çš„æ‰€æœ‰åˆ†é‡ç±»å‹éƒ½æ˜¯Copy Typeï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡attributeå°†è¯¥ç±»å‹å£°æ˜ä¸ºCopy Type</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="912" data-line-end="917" class="language-rust"><span class="hljs-keyword">struct</span> C { x: <span class="hljs-keyword">u32</span> }
<span class="hljs-keyword">let</span> l = C { x: <span class="hljs-number">3</span> };
f(l);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, l.x); <span class="hljs-comment">//error</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="919" data-line-end="925" class="language-rust"><span class="hljs-preprocessor">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> C { x: <span class="hljs-keyword">u32</span> }
<span class="hljs-keyword">let</span> l = C { x: <span class="hljs-number">3</span> };
f(l);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>. l.x); <span class="hljs-comment">//3</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="927" data-line-end="933" class="language-rust"><span class="hljs-preprocessor">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> C { x: <span class="hljs-keyword">u32</span>, s: <span class="hljs-built_in">String</span> }
<span class="hljs-keyword">let</span> l = C { x: <span class="hljs-number">3</span>, s: String::from(<span class="hljs-string">"dog"</span>) }; <span class="hljs-comment">//error</span>
f(l);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>. l.x);
</code></pre>
<h5 class="code-line" data-line-start=934 data-line-end=935 ><a id="_934"></a>å…±äº«æ‰€æœ‰æƒ</h5>
<pre><code class="has-line-data" data-line-start="937" data-line-end="953" class="language-rust"><span class="hljs-keyword">use</span> std::rc::Rc;

<span class="hljs-comment">//å¯ä»¥ä¸å¿…å†™ç±»å‹å£°æ˜</span>
<span class="hljs-keyword">let</span> s: Rc&lt;<span class="hljs-built_in">String</span>&gt; = Rc::new(String::from(<span class="hljs-string">"dog"</span>));
<span class="hljs-keyword">let</span> t: Rc&lt;<span class="hljs-built_in">String</span>&gt; = s.clone(); <span class="hljs-comment">//Method-call syntax</span>
<span class="hljs-keyword">let</span> u: Rc&lt;<span class="hljs-built_in">String</span>&gt; = Rc::clone(&amp;s); <span class="hljs-comment">//Fully qualified syntax</span>

<span class="hljs-comment">//å¯ä»¥åœ¨Rc&lt;T&gt;ç±»å‹çš„å€¼ä¸Šç›´æ¥è°ƒç”¨Tç±»å‹çš„å€¼ä¸Šçš„æ–¹æ³•</span>

<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, RC::strong_count(&amp;s)); <span class="hljs-comment">//3</span>

<span class="hljs-keyword">let</span> t = <span class="hljs-number">0</span>;
<span class="hljs-keyword">let</span> u = <span class="hljs-number">1</span>;

<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, RC::strong_count(&amp;s)); <span class="hljs-comment">//3</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="954" data-line-end="956">è¢«Rcæ‹¥æœ‰çš„å€¼ä¸å¯ä¿®æ”¹</li>
</ul>
<pre><code class="has-line-data" data-line-start="957" data-line-end="960" class="language-rust"><span class="hljs-keyword">let</span> s = Rc::new(String::from(<span class="hljs-string">"dog"</span>));
s.push_str(<span class="hljs-string">"!"</span>); <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="961" data-line-end="965">
<p class="has-line-data" data-line-start="961" data-line-end="962">Rcï¼šnon-thread-safeï¼Œé€Ÿåº¦å¿«</p>
<p class="has-line-data" data-line-start="963" data-line-end="964">Arcï¼šthread-safeï¼Œé€Ÿåº¦æ…¢</p>
</li>
<li class="has-line-data" data-line-start="965" data-line-end="967">
<p class="has-line-data" data-line-start="965" data-line-end="966">ä½¿ç”¨å»ºè®®ï¼šå§‹ç»ˆç”¨Rcï¼Œé™¤éç¼–è¯‘å™¨å‘Šè¯‰ç”¨Arcï¼ˆå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨Rcä¼šè¢«ç¼–è¯‘å™¨æ£€æŸ¥å‡ºæ¥ï¼‰</p>
</li>
</ul>
<h3 class="code-line" data-line-start=967 data-line-end=968 ><a id="04__967"></a>04 å¼•ç”¨</h3>
<h5 class="code-line" data-line-start=969 data-line-end=970 ><a id="_969"></a>å¼•ç”¨</h5>
<ul>
<li class="has-line-data" data-line-start="971" data-line-end="979">
<p class="has-line-data" data-line-start="971" data-line-end="972">å…±äº«å‹å¼•ç”¨ï¼ˆshared referenceï¼‰</p>
<p class="has-line-data" data-line-start="973" data-line-end="974">åªèƒ½è¯»å–ï¼Œä¸èƒ½ä¿®æ”¹ï¼Œä»è¯¥å€¼å‡ºå‘å¯ä»¥è®¿é—®åˆ°çš„ä»»ä½•ä¸œè¥¿éƒ½ä¸èƒ½è¢«æ”¹å˜</p>
<p class="has-line-data" data-line-start="975" data-line-end="976">ä»»ä¸€æ—¶åˆ»ä¸€ä¸ªå€¼å¯æœ‰ä»»æ„å¤šä¸ª</p>
<p class="has-line-data" data-line-start="977" data-line-end="978">åªè¦å­˜åœ¨å…±äº«å¼•ç”¨ï¼Œæ‰€æœ‰è€…ä¹Ÿä¸èƒ½ä¿®æ”¹</p>
</li>
<li class="has-line-data" data-line-start="979" data-line-end="987">
<p class="has-line-data" data-line-start="979" data-line-end="980">å¯å˜å‹å¼•ç”¨ï¼ˆmutable reference)</p>
<p class="has-line-data" data-line-start="981" data-line-end="982">è¯»å–ã€ä¿®æ”¹å‡å¯</p>
<p class="has-line-data" data-line-start="983" data-line-end="984">ä»»ä¸€æ—¶åˆ»æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œæ­¤åˆ»ä¸èƒ½å†æœ‰åªè¯»å¼•ç”¨</p>
<p class="has-line-data" data-line-start="985" data-line-end="986">åªè¦å­˜åœ¨å¯å˜å¼•ç”¨ï¼Œæ‰€æœ‰è€…æ— æ³•è®¿é—®</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="988" data-line-end="991" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> r = &amp;x;
</code></pre>
<pre><code class="has-line-data" data-line-start="993" data-line-end="997" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> m = &amp;<span class="hljs-keyword">mut</span> x;
*m = <span class="hljs-number">20</span>;
</code></pre>
<ul>
<li class="has-line-data" data-line-start="998" data-line-end="1000">æ“ä½œç¬¦å·¦ä¾§çš„å¼•ç”¨/éå¼•ç”¨</li>
</ul>
<pre><code class="has-line-data" data-line-start="1001" data-line-end="1007" class="language-rust"><span class="hljs-keyword">struct</span> C {x: <span class="hljs-keyword">i32</span>}
<span class="hljs-keyword">let</span> c = C {x: <span class="hljs-number">5</span>};
<span class="hljs-keyword">let</span> r = &amp;c;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, (*r).x);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r.x); <span class="hljs-comment">//è‡ªåŠ¨dereferenceï¼Œå®Œå…¨ç­‰ä»·</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1009" data-line-end="1013" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>];
(&amp;<span class="hljs-keyword">mut</span> v).sort();
v.sort(); <span class="hljs-comment">//è‡ªåŠ¨referenceï¼Œå®Œå…¨ç­‰ä»·</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1014" data-line-end="1016">å¯¹å¼•ç”¨çš„èµ‹å€¼</li>
</ul>
<pre><code class="has-line-data" data-line-start="1017" data-line-end="1024" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> y = <span class="hljs-number">20</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> r = &amp;x;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r); <span class="hljs-comment">//10</span>
r = &amp;y;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r); <span class="hljs-comment">//20</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1026" data-line-end="1037" class="language-cpp"><span class="hljs-keyword">int</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">int</span> y = <span class="hljs-number">20</span>;
<span class="hljs-keyword">int</span> &amp;r = x;
<span class="hljs-built_in">cout</span> &lt;&lt; r; <span class="hljs-comment">//10</span>
r = y;
y = <span class="hljs-number">30</span>;
<span class="hljs-built_in">cout</span> &lt;&lt; r; <span class="hljs-comment">//20</span>
<span class="hljs-built_in">cout</span> &lt;&lt; x; <span class="hljs-comment">//20</span>
<span class="hljs-built_in">cout</span> &lt;&lt; y; <span class="hljs-comment">//30</span>
<span class="hljs-comment">//C++å¼•ç”¨åœ¨åˆ›å»ºåä¸èƒ½å†å¼•ç”¨å¦å¤–çš„å€¼</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1038" data-line-end="1040">å¼•ç”¨çš„å¼•ç”¨</li>
</ul>
<pre><code class="has-line-data" data-line-start="1041" data-line-end="1048" class="language-rust"><span class="hljs-keyword">struct</span> C {x: <span class="hljs-keyword">i32</span>}
<span class="hljs-keyword">let</span> c = C {x: <span class="hljs-number">5</span>}
<span class="hljs-keyword">let</span> r = &amp;c;
<span class="hljs-keyword">let</span> rr = &amp;r;
<span class="hljs-keyword">let</span> rrr = &amp;rr;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, rrr.x); <span class="hljs-comment">//5</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1049" data-line-end="1051">å¼•ç”¨çš„æ¯”è¾ƒ</li>
</ul>
<pre><code class="has-line-data" data-line-start="1052" data-line-end="1064" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> y = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> rx = &amp;x;
<span class="hljs-keyword">let</span> ry = &amp;y;
<span class="hljs-keyword">let</span> rrx = &amp;rx;
<span class="hljs-keyword">let</span> rry = &amp;ry;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, rrx == rry); <span class="hljs-comment">//trueï¼Œçœ‹ç©¿ä»»æ„å±‚æ•°çš„å¼•ç”¨</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, rrx &lt; ry); <span class="hljs-comment">//errorï¼Œç±»å‹å¿…é¡»ç›¸åŒ</span>

<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:p}"</span>, rx); <span class="hljs-comment">//xçš„åœ°å€</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, std::ptr::eq(rx, ry)); <span class="hljs-comment">//false</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1065" data-line-end="1067">ç©ºå¼•ç”¨</li>
</ul>
<pre><code class="has-line-data" data-line-start="1068" data-line-end="1075" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> r = <span class="hljs-built_in">Some</span>(&amp;x); <span class="hljs-comment">//Option&lt;&amp;i32&gt;</span>
<span class="hljs-keyword">let</span> null = <span class="hljs-built_in">None</span>;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r == null); <span class="hljs-comment">//false</span>
<span class="hljs-keyword">let</span> r = r.expect(<span class="hljs-string">"ç©ºæŒ‡é’ˆ"</span>);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1076" data-line-end="1078">åœ¨ä»»æ„è¡¨è¾¾å¼ä¸Šåˆ›å»ºå¼•ç”¨</li>
</ul>
<pre><code class="has-line-data" data-line-start="1079" data-line-end="1085" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">fac</span></span>(n: usize) -&gt; usize {
    (<span class="hljs-number">1</span>..n+<span class="hljs-number">1</span>).product()
}
<span class="hljs-keyword">let</span> r = &amp;fac(<span class="hljs-number">5</span>);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r + &amp;<span class="hljs-number">1</span>); <span class="hljs-comment">//121ï¼Œçœ‹ç©¿åŒä¸€å±‚å¼•ç”¨</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1086" data-line-end="1090">
<p class="has-line-data" data-line-start="1086" data-line-end="1087">å¯¹sliceçš„å¼•ç”¨</p>
<p class="has-line-data" data-line-start="1088" data-line-end="1089">ç±»å‹&amp;[T]ï¼Œä¸€ç§fat pointerï¼ŒåŒ…å«é¦–å…ƒç´ åœ°å€ã€å…ƒç´ æ•°é‡</p>
</li>
</ul>
<h5 class="code-line" data-line-start=1090 data-line-end=1091 ><a id="_1090"></a>å¼•ç”¨çš„å®‰å…¨æ€§</h5>
<ul>
<li class="has-line-data" data-line-start="1092" data-line-end="1094">åœ¨å±€éƒ¨å˜é‡ä¸Šåˆ›å»ºå¼•ç”¨</li>
</ul>
<pre><code class="has-line-data" data-line-start="1095" data-line-end="1102" class="language-rust"><span class="hljs-keyword">let</span> r;
{
    <span class="hljs-keyword">let</span> x = <span class="hljs-number">1</span>;
    r = &amp;x;
}
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r); <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1103" data-line-end="1109">
<p class="has-line-data" data-line-start="1103" data-line-end="1104">Lifetime</p>
<p class="has-line-data" data-line-start="1105" data-line-end="1106">çº¦æŸ1ï¼š&amp;xçš„lifetimeä¸èƒ½è¶…è¿‡xçš„lifetime</p>
<p class="has-line-data" data-line-start="1107" data-line-end="1108">çº¦æŸ2ï¼š&amp;xèµ‹ç»™å˜é‡rï¼Œ&amp;xçš„lifetimeä¸èƒ½å°äºè¯­å¥r=&amp;xåˆ°rçš„lifetimeç»ˆæ­¢å¤„</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1110" data-line-end="1116" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-number">1</span>;
{
    <span class="hljs-keyword">let</span> r = &amp;x;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r);
}
</code></pre>
<pre><code class="has-line-data" data-line-start="1118" data-line-end="1122" class="language-rust"><span class="hljs-keyword">let</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> r = &amp;v[<span class="hljs-number">1</span>];
<span class="hljs-comment">//v[1] &gt;= &amp;v[1] &gt;= r</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1124" data-line-end="1130" class="language-rust"><span class="hljs-keyword">let</span> x = <span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> y = <span class="hljs-number">2</span>;
<span class="hljs-keyword">let</span> rv = <span class="hljs-built_in">vec!</span>[&amp;x, &amp;y];
<span class="hljs-comment">//x &gt;= &amp;x &gt;= rv</span>
<span class="hljs-comment">//y &gt;= &amp;y &gt;- rv</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1131" data-line-end="1133">å¼•ç”¨ä½œä¸ºå‡½æ•°å‚æ•°</li>
</ul>
<pre><code class="has-line-data" data-line-start="1134" data-line-end="1142" class="language-rust"><span class="hljs-comment">//å…¨å±€å˜é‡lifetimeä¸ç¨‹åºè¿è¡Œçš„lifetimeç›¸åŒ</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">mut</span> S: &amp;<span class="hljs-keyword">i32</span> = &amp;<span class="hljs-number">0</span>; <span class="hljs-comment">//å…¨å±€å˜é‡å¿…é¡»åˆå§‹åŒ–</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>&lt;<span class="hljs-string">'a</span>&gt;(p: &amp;<span class="hljs-string">'a</span> <span class="hljs-keyword">i32</span>) {
    <span class="hljs-keyword">unsafe</span> {
        S = p; <span class="hljs-comment">//å¿…é¡»æ»¡è¶³çº¦æŸp &gt;= Sï¼Œä½†ä¸æ€»æ˜¯æ»¡è¶³ </span>
    } <span class="hljs-comment">//åªèƒ½åœ¨unsafeä»£ç å—è®¿é—®å¯å˜å…¨å±€å˜é‡</span>
}
</code></pre>
<pre><code class="has-line-data" data-line-start="1144" data-line-end="1151" class="language-rust"><span class="hljs-keyword">static</span> <span class="hljs-keyword">mut</span> S: &amp;<span class="hljs-keyword">i32</span> = &amp;<span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(p: &amp;<span class="hljs-string">'static</span> <span class="hljs-keyword">i32</span>) {
    <span class="hljs-keyword">unsafe</span> {
        S = p;
    }
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1152" data-line-end="1154">è°ƒç”¨å…·æœ‰å¼•ç”¨å‚æ•°çš„å‡½æ•°</li>
</ul>
<pre><code class="has-line-data" data-line-start="1155" data-line-end="1161" class="language-rust"><span class="hljs-keyword">static</span> T: <span class="hljs-keyword">i32</span> = <span class="hljs-number">1024</span>;
f(&amp;T);
<span class="hljs-keyword">unsafe</span> {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, S);
}
</code></pre>
<pre><code class="has-line-data" data-line-start="1163" data-line-end="1166" class="language-rust"><span class="hljs-keyword">let</span> t: <span class="hljs-keyword">i32</span> = <span class="hljs-number">1024</span>;
f(&amp;t); <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1167" data-line-end="1169">å‡½æ•°è¿”å›å¼•ç”¨</li>
</ul>
<pre><code class="has-line-data" data-line-start="1170" data-line-end="1185" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(v: &amp;[<span class="hljs-keyword">i32</span>]) -&gt; &amp;<span class="hljs-keyword">i32</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s = &amp;v[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> &amp;v[<span class="hljs-number">1</span>..] {
        <span class="hljs-keyword">if</span> r &lt; s { s = r; }
    }
    s
}
<span class="hljs-keyword">let</span> s;
{
    <span class="hljs-keyword">let</span> v = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
    s = f(&amp;v);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, s); <span class="hljs-comment">//ok</span>
}
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, s); <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1186" data-line-end="1188">structä¸­åŒ…å«å¼•ç”¨</li>
</ul>
<pre><code class="has-line-data" data-line-start="1189" data-line-end="1191" class="language-rust"><span class="hljs-keyword">struct</span> S { r: &amp;<span class="hljs-keyword">i32</span> } <span class="hljs-comment">//error</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1193" data-line-end="1201" class="language-rust"><span class="hljs-keyword">struct</span> S&lt;<span class="hljs-string">'a</span>&gt; { r: &amp;<span class="hljs-string">'a</span> <span class="hljs-keyword">i32</span> }
<span class="hljs-keyword">let</span> s;
{
    <span class="hljs-keyword">let</span> x = <span class="hljs-number">10</span>;
    s = S { r: &amp;x };
}
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, s.r); <span class="hljs-comment">//error</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1203" data-line-end="1206" class="language-rust"><span class="hljs-keyword">struct</span> D { s: S&lt;<span class="hljs-string">'static</span>&gt; } <span class="hljs-comment">//D.s.råªèƒ½å­˜æ”¾static reference</span>
<span class="hljs-keyword">struct</span> D&lt;<span class="hljs-string">'a</span>&gt; { s: S&lt;<span class="hljs-string">'a</span>&gt; }
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1207" data-line-end="1209">ä¸åŒçš„lifetimes</li>
</ul>
<pre><code class="has-line-data" data-line-start="1210" data-line-end="1230" class="language-rust"><span class="hljs-keyword">struct</span> S&lt;<span class="hljs-string">'a</span>&gt; { 
    x: &amp;<span class="hljs-string">'a</span> <span class="hljs-keyword">i32</span>,
    y: &amp;<span class="hljs-string">'a</span> <span class="hljs-keyword">i32</span>
}
<span class="hljs-keyword">let</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> r;
{
    <span class="hljs-keyword">let</span> y = <span class="hljs-number">20</span>;
    {
        <span class="hljs-keyword">let</span> s = S { x: &amp;x, y: &amp;y};
        r = s.x
    }
}
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r);
<span class="hljs-comment">//s.x = s.y</span>
<span class="hljs-comment">//s.x &gt;= r</span>
<span class="hljs-comment">//y &gt;= s.y</span>
<span class="hljs-comment">//y &lt; r</span>
<span class="hljs-comment">//ä¸åº”è¯¥é™åˆ¶s.x == s.y</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1232" data-line-end="1237" class="language-rust"><span class="hljs-keyword">struct</span> S&lt;<span class="hljs-string">'a</span>, <span class="hljs-string">'b</span>&gt; { 
    x: &amp;<span class="hljs-string">'a</span> <span class="hljs-keyword">i32</span>,
    y: &amp;<span class="hljs-string">'b</span> <span class="hljs-keyword">i32</span>
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1238" data-line-end="1240">çœç•¥å‡½æ•°ç­¾åä¸­å¼•ç”¨çš„lifetimeå‚æ•°</li>
</ul>
<pre><code class="has-line-data" data-line-start="1241" data-line-end="1245" class="language-rust"><span class="hljs-comment">//æœ€ç®€å•æƒ…å†µä¸‹ï¼Œä¸ºæ¯ä¸€ä¸ªå¼•ç”¨å£°æ˜ç‹¬ç«‹çš„lifetimeå‚æ•°</span>
<span class="hljs-keyword">struct</span> S&lt;<span class="hljs-string">'a</span>, <span class="hljs-string">'b</span>&gt; {}
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>&lt;<span class="hljs-string">'a</span>, <span class="hljs-string">'b</span>, <span class="hljs-string">'c</span>&gt;(r: &amp;<span class="hljs-string">'a</span> <span class="hljs-keyword">i32</span>, s: S&lt;<span class="hljs-string">'b</span>, <span class="hljs-string">'c</span>&gt;) -&gt; <span class="hljs-keyword">i32</span> {}
</code></pre>
<pre><code class="has-line-data" data-line-start="1247" data-line-end="1250" class="language-rust"><span class="hljs-comment">//æ‰€æœ‰å‚æ•°ä»…æ¶‰åŠä¸€ä¸ªlifetimeï¼Œè®¤ä¸ºå‚æ•°å’Œè¿”å›å€¼æ¶‰åŠçš„lifetimeç›¸åŒ</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>&lt;<span class="hljs-string">'a</span>&gt;(p: &amp;<span class="hljs-string">'a</span> [<span class="hljs-keyword">i32</span>; <span class="hljs-number">3</span>]) -&gt; (&amp;<span class="hljs-string">'a</span> <span class="hljs-keyword">i32</span>, &amp;<span class="hljs-string">'a</span> <span class="hljs-keyword">i32</span>) {}
</code></pre>
<pre><code class="has-line-data" data-line-start="1252" data-line-end="1255" class="language-rust"><span class="hljs-comment">//é™„ç€åœ¨structä¸Šçš„æ–¹æ³•ï¼Œå…·æœ‰å‚æ•°&amp;selfï¼Œè¿”å›å€¼æ¶‰åŠçš„lifetimeå’Œselfç›¸åŒ</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>&lt;<span class="hljs-string">'a</span>, <span class="hljs-string">'b</span>&gt;(&amp;<span class="hljs-string">'a</span> <span class="hljs-keyword">self</span>, p: &amp;<span class="hljs-string">'b</span> <span class="hljs-keyword">str</span>) -&gt; <span class="hljs-built_in">Option</span>&lt;&amp;<span class="hljs-string">'b</span> <span class="hljs-built_in">String</span>&gt; {}
</code></pre>
<h5 class="code-line" data-line-start=1256 data-line-end=1257 ><a id="_1256"></a>å…±äº«ä¸å¯å˜</h5>
<ul>
<li class="has-line-data" data-line-start="1258" data-line-end="1260">æ‚¬ç©ºæŒ‡é’ˆ</li>
</ul>
<pre><code class="has-line-data" data-line-start="1261" data-line-end="1268" class="language-rust"><span class="hljs-keyword">let</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> r = &amp;v;
<span class="hljs-keyword">let</span> u = v; <span class="hljs-comment">//errorï¼Œæ‰€æœ‰æƒè½¬ç§»</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r[<span class="hljs-number">0</span>]);

<span class="hljs-comment">//å…±äº«å‹æŒ‡é’ˆçš„lifetimeå†…ï¼Œè¢«æŒ‡é’ˆå¼•ç”¨çš„ä¸å¯å˜ï¼Œä¸èƒ½å‘ç”Ÿæ‰€æœ‰æƒè½¬ç§»</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1270" data-line-end="1275" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(vec: &amp;<span class="hljs-keyword">mut</span> <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt;, slice: &amp;[<span class="hljs-keyword">i32</span>]) {}

<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
f(&amp;<span class="hljs-keyword">mut</span> v, &amp;v); <span class="hljs-comment">//errorï¼Œå·²å­˜åœ¨å¯å˜å¼•ç”¨</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1276" data-line-end="1280">
<p class="has-line-data" data-line-start="1276" data-line-end="1277">å…±äº«å‹ï¼šå­æ ‘ä¸å¯æ”¹å˜ï¼Œåˆ°æ ¹è·¯å¾„ä¸å¯æ”¹å˜</p>
<p class="has-line-data" data-line-start="1278" data-line-end="1279">å¯å˜å‹ï¼šå­æ ‘è¢«å¼•ç”¨ç‹¬å ï¼Œåˆ°æ ¹è·¯å¾„ä¸å¯è¢«è®¿é—®</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1281" data-line-end="1287" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> w = (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
<span class="hljs-keyword">let</span> r = &amp;w;
<span class="hljs-keyword">let</span> r0 = &amp;r.<span class="hljs-number">0</span>; <span class="hljs-comment">//ok</span>
<span class="hljs-keyword">let</span> m1 = &amp;<span class="hljs-keyword">mut</span> r.<span class="hljs-number">1</span>; <span class="hljs-comment">//error</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r0);
</code></pre>
<pre><code class="has-line-data" data-line-start="1289" data-line-end="1297" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> w = (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
<span class="hljs-keyword">let</span> m = &amp;<span class="hljs-keyword">mut</span> w;
<span class="hljs-keyword">let</span> m0 = &amp;<span class="hljs-keyword">mut</span> m.<span class="hljs-number">0</span>; <span class="hljs-comment">//ok</span>
*m0 = <span class="hljs-number">3</span>;
<span class="hljs-keyword">let</span> r1 = &amp;m.<span class="hljs-number">1</span>; <span class="hljs-comment">//ok</span>
w.<span class="hljs-number">1</span>; <span class="hljs-comment">//error</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r1);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1298" data-line-end="1300">Cä¸­çš„pointer to const</li>
</ul>
<pre><code class="has-line-data" data-line-start="1301" data-line-end="1306" class="language-c++"><span class="hljs-keyword">int</span> x = <span class="hljs-number">1</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> *p = &amp;x;
x++;
<span class="hljs-built_in">cout</span> &lt;&lt; p; <span class="hljs-comment">//2</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1308" data-line-end="1312" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> x = <span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> p = &amp;x;
x += <span class="hljs-number">1</span>; <span class="hljs-comment">//error</span>
</code></pre>
<h5 class="code-line" data-line-start=1313 data-line-end=1314 ><a id="_1313"></a>ç»è¿‡åæ€å½¢æˆçš„ä¸€äº›ä¿¡æ¯</h5>
<ul>
<li class="has-line-data" data-line-start="1315" data-line-end="1317">æ‰€æœ‰æƒä¸åŒ…å«å¯å˜æ€§</li>
</ul>
<pre><code class="has-line-data" data-line-start="1318" data-line-end="1322" class="language-rust"><span class="hljs-keyword">let</span> s = String::from(<span class="hljs-string">"hello"</span>);
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s_m = s;
s_m.push_str(<span class="hljs-string">" world"</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="1324" data-line-end="1328" class="language-rust"><span class="hljs-keyword">let</span> s = String::from(<span class="hljs-string">"hello"</span>);
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(<span class="hljs-keyword">mut</span> s_m: <span class="hljs-built_in">String</span>) {}
print(s);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1329" data-line-end="1331">Cä¸­å››ç§å½¢å¼çš„pointer</li>
</ul>
<pre><code class="has-line-data" data-line-start="1332" data-line-end="1337" class="language-c++"><span class="hljs-comment">//pointer</span>
<span class="hljs-keyword">int</span> *p = &amp;x;
*p = <span class="hljs-number">3</span>;
p = &amp;y;
</code></pre>
<pre><code class="has-line-data" data-line-start="1339" data-line-end="1344" class="language-c++"><span class="hljs-comment">//pointer to const</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> *p = &amp;x;
*p = <span class="hljs-number">3</span>; <span class="hljs-comment">//error</span>
p = &amp;y;
</code></pre>
<pre><code class="has-line-data" data-line-start="1346" data-line-end="1351" class="language-rust"><span class="hljs-comment">//const pointer</span>
<span class="hljs-keyword">int</span> * <span class="hljs-keyword">const</span> p = &amp;x;
*p = <span class="hljs-number">3</span>; 
p = &amp;y; <span class="hljs-comment">//error</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1353" data-line-end="1358" class="language-rust"><span class="hljs-comment">//const pointer to const</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> * <span class="hljs-keyword">const</span> p = &amp;x;
*p = <span class="hljs-number">3</span>; <span class="hljs-comment">//error</span>
p = &amp;y; <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1359" data-line-end="1361">Rustä¸­å››ç§å¼•ç”¨</li>
</ul>
<pre><code class="has-line-data" data-line-start="1362" data-line-end="1367" class="language-rust"><span class="hljs-keyword">let</span> p: &amp;<span class="hljs-keyword">i32</span> = &amp;a; <span class="hljs-comment">//const pointer to const</span>
<span class="hljs-keyword">let</span> p: &amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">i32</span> = &amp;<span class="hljs-keyword">mut</span> a; <span class="hljs-comment">//const pointer</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> p: &amp;<span class="hljs-keyword">i32</span> = &amp;a; <span class="hljs-comment">//pointer to const</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> p: &amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">i32</span> = &amp;a; <span class="hljs-comment">//pointer</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1368" data-line-end="1372">
<p class="has-line-data" data-line-start="1368" data-line-end="1369">Rustä¸­Boxç±»å‹pointerä¸å…·æœ‰å››ç§å½¢å¼</p>
<p class="has-line-data" data-line-start="1370" data-line-end="1371">Boxç±»å‹çš„pointerå¯¹æ‰€æŒ‡çš„å€¼æœ‰æ‰€æœ‰æƒï¼Œå †ä¸­å€¼ä¾é™„äºæ ˆä¸­å€¼</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1373" data-line-end="1381" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> a Box::new(<span class="hljs-number">0</span>);
*a = <span class="hljs-number">1</span>; <span class="hljs-comment">//ok</span>
a = Box::new(<span class="hljs-number">2</span>); <span class="hljs-comment">//ok</span>

<span class="hljs-keyword">let</span> a = Box::new(<span class="hljs-number">0</span>);
*a = <span class="hljs-number">1</span>; <span class="hljs-comment">//error</span>
a = Box::new(<span class="hljs-number">2</span>); <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1382" data-line-end="1384">é™å®šæ ˆå€¼ä¸å˜ï¼Œå †å€¼å¯å˜</li>
</ul>
<pre><code class="has-line-data" data-line-start="1385" data-line-end="1388" class="language-rust"><span class="hljs-keyword">let</span> p = &amp;<span class="hljs-keyword">mut</span> <span class="hljs-number">0</span>;
*p = <span class="hljs-number">1</span>;
</code></pre>
<pre><code class="has-line-data" data-line-start="1390" data-line-end="1393" class="language-rust"><span class="hljs-keyword">let</span> p = &amp;<span class="hljs-keyword">mut</span> String::from(<span class="hljs-string">"hello"</span>);
p.push_str(<span class="hljs-string">" world"</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="1395" data-line-end="1398" class="language-rust"><span class="hljs-keyword">let</span> p = &amp;<span class="hljs-keyword">mut</span> *Box::new(<span class="hljs-number">0</span>);
*p = <span class="hljs-number">1</span>;
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1399" data-line-end="1401">shadow</li>
</ul>
<pre><code class="has-line-data" data-line-start="1402" data-line-end="1407" class="language-rust"><span class="hljs-keyword">let</span> s = <span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> r = &amp;s;
<span class="hljs-keyword">let</span> s = <span class="hljs-number">2</span>; <span class="hljs-comment">//ok</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r); <span class="hljs-comment">//1</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1408" data-line-end="1410">å¼•ç”¨å¸¸æ•°/è¡¨è¾¾å¼</li>
</ul>
<pre><code class="has-line-data" data-line-start="1411" data-line-end="1418" class="language-rust"><span class="hljs-keyword">let</span> r;
{
    <span class="hljs-keyword">let</span> x = <span class="hljs-number">1</span>;
    r = &amp;<span class="hljs-number">0</span>; <span class="hljs-comment">//0å­˜æ”¾åœ¨é™æ€æ•°æ®åŒº</span>
}
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, r);
</code></pre>
<pre><code class="has-line-data" data-line-start="1420" data-line-end="1423" class="language-rust"><span class="hljs-keyword">let</span> r = &amp;fac(<span class="hljs-number">6</span>); <span class="hljs-comment">//æ ˆä¸­</span>
r = &amp;fac(<span class="hljs-number">6</span>); <span class="hljs-comment">//error</span>
</code></pre>
<h3 class="code-line" data-line-start=1424 data-line-end=1425 ><a id="05__1424"></a>05 è¡¨è¾¾å¼</h3>
<h5 class="code-line" data-line-start=1426 data-line-end=1427 ><a id="_1426"></a>ä»£ç å—</h5>
<pre><code class="has-line-data" data-line-start="1429" data-line-end="1435" class="language-rust"><span class="hljs-keyword">let</span> a = {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"hello"</span>);
    <span class="hljs-number">1</span> + <span class="hljs-number">2</span>;
};
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, a); <span class="hljs-comment">//()</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1437" data-line-end="1443" class="language-rust"><span class="hljs-keyword">let</span> a = {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"hello"</span>);
    <span class="hljs-number">1</span> + <span class="hljs-number">2</span> 
};
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, a); <span class="hljs-comment">//3</span>
</code></pre>
<h5 class="code-line" data-line-start=1444 data-line-end=1445 ><a id="_1444"></a>åˆ†æ”¯è¡¨è¾¾å¼</h5>
<ul>
<li class="has-line-data" data-line-start="1446" data-line-end="1448">let declaration</li>
</ul>
<pre><code class="has-line-data" data-line-start="1449" data-line-end="1458" class="language-rust"><span class="hljs-keyword">let</span> b;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, b); <span class="hljs-comment">//error</span>
<span class="hljs-keyword">if</span> a &gt; <span class="hljs-number">0</span> {
    b = <span class="hljs-keyword">true</span>;
} 
<span class="hljs-keyword">else</span> {
    b = <span class="hljs-keyword">false</span>;
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1459" data-line-end="1461">if-else expr</li>
</ul>
<pre><code class="has-line-data" data-line-start="1462" data-line-end="1469" class="language-rust"><span class="hljs-keyword">let</span> b = <span class="hljs-keyword">if</span> a &gt; <span class="hljs-number">0</span> {
    <span class="hljs-keyword">true</span>
} 
<span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">false</span>
};
</code></pre>
<pre><code class="has-line-data" data-line-start="1471" data-line-end="1478" class="language-rust"><span class="hljs-keyword">let</span> b = <span class="hljs-keyword">if</span> a &gt; <span class="hljs-number">0</span> {
    <span class="hljs-keyword">true</span>
} 
<span class="hljs-keyword">else</span> {
    <span class="hljs-number">0</span> <span class="hljs-comment">//error</span>
};
</code></pre>
<pre><code class="has-line-data" data-line-start="1480" data-line-end="1484" class="language-rust"><span class="hljs-keyword">let</span> b = <span class="hljs-keyword">if</span> a &gt; <span class="hljs-number">0</span> {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"hello"</span>);
}; <span class="hljs-comment">//ç¼–è¯‘å™¨æ·»åŠ elseåˆ†æ”¯ï¼Œå€¼ä¸º()</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1485" data-line-end="1487">match expression</li>
</ul>
<pre><code class="has-line-data" data-line-start="1488" data-line-end="1493" class="language-rust"><span class="hljs-keyword">match</span> code {
    <span class="hljs-number">0</span> =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"0"</span>),
    _ =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"1"</span>),
}
</code></pre>
<pre><code class="has-line-data" data-line-start="1495" data-line-end="1500" class="language-rust"><span class="hljs-keyword">let</span> name = <span class="hljs-keyword">match</span> a {
    <span class="hljs-built_in">Some</span>(v) =&gt; v,
    <span class="hljs-built_in">None</span> =&gt; String::from(<span class="hljs-string">"None"</span>)
};
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1501" data-line-end="1503">if let expr</li>
</ul>
<pre><code class="has-line-data" data-line-start="1504" data-line-end="1511" class="language-rust"><span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-built_in">Some</span>(v) = a {
    
} 
<span class="hljs-keyword">else</span> {
    
}
</code></pre>
<h5 class="code-line" data-line-start=1512 data-line-end=1513 ><a id="_1512"></a>å¾ªç¯è¡¨è¾¾å¼</h5>
<ul>
<li class="has-line-data" data-line-start="1514" data-line-end="1516">whileå¾ªç¯è¡¨è¾¾å¼</li>
</ul>
<pre><code class="has-line-data" data-line-start="1517" data-line-end="1529" class="language-rust"><span class="hljs-string">'outer</span>:
<span class="hljs-keyword">while</span> a &lt;= x {
    <span class="hljs-keyword">while</span> b &lt;= x {
        <span class="hljs-keyword">if</span> a * b == x {
            <span class="hljs-keyword">break</span> <span class="hljs-string">'outer</span>; <span class="hljs-comment">//è·³å‡ºåµŒå¥—å¾ªç¯</span>
        }
        b += <span class="hljs-number">1</span>;
    }
    a += <span class="hljs-number">1</span>;
    b = <span class="hljs-number">1</span>;
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1530" data-line-end="1532">while-letå¾ªç¯è¡¨è¾¾å¼</li>
</ul>
<pre><code class="has-line-data" data-line-start="1533" data-line-end="1541" class="language-rust"><span class="hljs-keyword">let</span> a = [<span class="hljs-built_in">Some</span>(<span class="hljs-string">"a"</span>), <span class="hljs-built_in">Some</span>(<span class="hljs-string">"b"</span>), <span class="hljs-built_in">None</span>, <span class="hljs-built_in">Some</span>(<span class="hljs-string">"c"</span>)];
<span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-built_in">Some</span>(s) = a[i] {
    i += <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> i == a.len() {
        <span class="hljs-keyword">break</span>;
    }
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1542" data-line-end="1544">forå¾ªç¯è¡¨è¾¾å¼</li>
</ul>
<pre><code class="has-line-data" data-line-start="1545" data-line-end="1554" class="language-rust"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> a {
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-built_in">Some</span>(s) = e {
        i += <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">break</span>;
    }
}
</code></pre>
<pre><code class="has-line-data" data-line-start="1556" data-line-end="1559" class="language-rust"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>..=<span class="hljs-number">100</span> {}
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>..<span class="hljs-number">101</span> {}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1560" data-line-end="1562">loopå¾ªç¯è¡¨è¾¾å¼</li>
</ul>
<pre><code class="has-line-data" data-line-start="1563" data-line-end="1576" class="language-rust"><span class="hljs-keyword">let</span> sqrt = <span class="hljs-string">'outer</span>: <span class="hljs-keyword">loop</span> {
    n += <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>.. {
        <span class="hljs-keyword">let</span> sqr = i * i;
        <span class="hljs-keyword">if</span> sqr == n {
            <span class="hljs-keyword">break</span> <span class="hljs-string">'outer</span> i; <span class="hljs-comment">//breakåæ”¾ä¸€ä¸ªå€¼</span>
        }
        <span class="hljs-keyword">if</span> sqr &gt; n {
            <span class="hljs-keyword">break</span>;
        }
    }
};
</code></pre>
<h5 class="code-line" data-line-start=1577 data-line-end=1578 ><a id="return_expr_1577"></a>return expr</h5>
<ul>
<li class="has-line-data" data-line-start="1579" data-line-end="1581">ç»ˆæ­¢å‡½æ•°ï¼Œè¿”å›è¡¨è¾¾å¼çš„å€¼</li>
</ul>
<h5 class="code-line" data-line-start=1581 data-line-end=1582 ><a id="_1581"></a>è¿ç®—</h5>
<pre><code class="has-line-data" data-line-start="1584" data-line-end="1589" class="language-rust"><span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, -<span class="hljs-number">100u32</span>); <span class="hljs-comment">//errorï¼Œ-ä¸èƒ½ä½œç”¨åœ¨æ— ç¬¦å·æ•´æ•°ä¸Š</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, +<span class="hljs-number">100</span>); <span class="hljs-comment">//errorï¼Œä¸å­˜åœ¨æ„æ„¿æ“ä½œç¬¦+</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, <span class="hljs-number">123.4</span> % <span class="hljs-number">10.0</span>); <span class="hljs-comment">//%é€‚ç”¨äºæµ®ç‚¹æ•°</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, !<span class="hljs-number">0x10</span>); <span class="hljs-comment">//æŒ‰ä½å–åæ˜¯!</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1590" data-line-end="1591">ä½è¿ç®—ä¼˜å…ˆçº§é«˜äºæ¯”è¾ƒè¿ç®—</li>
<li class="has-line-data" data-line-start="1591" data-line-end="1592">æ¯”è¾ƒè¿ç®—ç¬¦ä¸¤ä¸ªæ“ä½œæ•°ç±»å‹å¿…é¡»ç›¸åŒ</li>
<li class="has-line-data" data-line-start="1592" data-line-end="1594">å¸¦æœ‰çŸ­è·¯è¡Œä¸ºçš„é€»è¾‘è¿ç®—æ“ä½œç¬¦ä¸¤ä¸ªæ“ä½œæ•°ç±»å‹å¿…é¡»ä¸ºbool</li>
</ul>
<h5 class="code-line" data-line-start=1594 data-line-end=1595 ><a id="_1594"></a>èµ‹å€¼</h5>
<ul>
<li class="has-line-data" data-line-start="1596" data-line-end="1597">å³ä¾§non-copy typeå‘ç”Ÿæ‰€æœ‰æƒè½¬ç§»</li>
<li class="has-line-data" data-line-start="1597" data-line-end="1598">æ”¯æŒå¤åˆèµ‹å€¼æ“ä½œç¬¦ï¼š+=</li>
<li class="has-line-data" data-line-start="1598" data-line-end="1599">ä¸æ”¯æŒè‡ªå¢è‡ªå‡ï¼š++ã€â€“</li>
<li class="has-line-data" data-line-start="1599" data-line-end="1601">ä¸æ”¯æŒé“¾å¼èµ‹å€¼ï¼ša = b = 1</li>
</ul>
<h5 class="code-line" data-line-start=1601 data-line-end=1602 ><a id="_1601"></a>ç±»å‹è½¬æ¢</h5>
<ul>
<li class="has-line-data" data-line-start="1603" data-line-end="1604">å†…ç½®æ•°å­—ç±»å‹é—´éƒ½å¯ç›¸äº’è½¬æ¢ï¼Œæµ®ç‚¹è½¬æ¢åˆ°æ•´æ•°å‘0å–æ•´</li>
<li class="has-line-data" data-line-start="1604" data-line-end="1605">boolã€charã€ç±»Cçš„enumç±»å‹å¯è½¬æ¢ä¸ºä»»ä½•æ•´æ•°ç±»å‹</li>
<li class="has-line-data" data-line-start="1605" data-line-end="1606">ä¸€äº›unsafe pointer typeä¹‹é—´ä¹Ÿå¯è½¬æ¢</li>
<li class="has-line-data" data-line-start="1606" data-line-end="1608">éšå¼è½¬æ¢ï¼š&amp;mut Tâ†’Tã€&amp;Stringâ†’&amp;strã€&amp;Vec&lt;T&gt;â†’&amp;[T]ã€&amp;Box&lt;T&gt;â†’&amp;T</li>
</ul>
<h3 class="code-line" data-line-start=1608 data-line-end=1609 ><a id="06__1608"></a>06 é”™è¯¯å¤„ç†</h3>
<h5 class="code-line" data-line-start=1610 data-line-end=1611 ><a id="_1610"></a>ç¨‹åºå†…éƒ¨é”™è¯¯</h5>
<ul>
<li class="has-line-data" data-line-start="1612" data-line-end="1613">åº”å¯¹æ–¹å¼ï¼španic</li>
<li class="has-line-data" data-line-start="1613" data-line-end="1614">ç¨‹åºæ£€æµ‹åˆ°æŸç§é”™è¯¯å³å°†å‘ç”Ÿï¼›ç¨‹åºåœ¨æ‰§è¡Œä¸­è°ƒç”¨äº†å®panic!</li>
<li class="has-line-data" data-line-start="1614" data-line-end="1615">unwindingï¼ˆç¼ºçœè¡Œä¸ºï¼‰ï¼šæ‰“å°é”™è¯¯ä¿¡æ¯ã€é€†åºé‡Šæ”¾ã€é€€å‡ºçº¿ç¨‹ï¼Œä¸å½±å“å…¶ä»–çº¿ç¨‹</li>
<li class="has-line-data" data-line-start="1615" data-line-end="1617">abortingï¼šunwindingè¿‡ç¨‹ä¸­å¯¹æŸä¸ªå€¼çš„dropæ–¹æ³•è°ƒç”¨åˆäº§ç”Ÿäº†panicï¼›ä½¿ç”¨ç¼–è¯‘å‚æ•°-C panic=abort</li>
</ul>
<h5 class="code-line" data-line-start=1617 data-line-end=1618 ><a id="_1617"></a>ç¨‹åºå¤–éƒ¨é”™è¯¯</h5>
<ul>
<li class="has-line-data" data-line-start="1619" data-line-end="1621">åº”å¯¹æ–¹å¼ï¼šthe Result type</li>
</ul>
<pre><code class="has-line-data" data-line-start="1622" data-line-end="1627" class="language-rust"><span class="hljs-keyword">enum</span> <span class="hljs-title">Result</span>&lt;T, E&gt; {
    <span class="hljs-built_in">Ok</span>(T),
    <span class="hljs-built_in">Err</span>(E),
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1628" data-line-end="1632">
<p class="has-line-data" data-line-start="1628" data-line-end="1629">Result&lt;T, E&gt;ä¸Šæ–¹æ³•</p>
<p class="has-line-data" data-line-start="1630" data-line-end="1631">é™¤is_okå’Œis_erréƒ½ä¼šæ‰€æœ‰æƒè½¬ç§»</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1633" data-line-end="1642" class="language-rust">rst.is_ok() <span class="hljs-comment">//Ok(T)è¿”å›trueï¼ŒErr(E)è¿”å›false</span>
rst.is_err() <span class="hljs-comment">//!rst.is_ok()</span>
rst.ok() <span class="hljs-comment">//è¿”å›Option&lt;T&gt;</span>
rst.err() <span class="hljs-comment">//è¿”å›Option&lt;E&gt;</span>
rst.unwrap() <span class="hljs-comment">//Ok(T)è¿”å›Tï¼Œå¦åˆ™panic</span>
rst.expect(msg) <span class="hljs-comment">//ä¸rst.unwrap()ç›¸åŒï¼Œè§¦å‘panicåæ‰“å°msg</span>
rst.unwrap_or(fallback) <span class="hljs-comment">//Ok(T)è¿”å›Tï¼Œå¦åˆ™è¿”å›fallback</span>
rst.unwrap_or_else(fallback_fn) <span class="hljs-comment">//Ok(T)è¿”å›Tï¼Œå¦åˆ™è¿”å›fallback_fn()çš„è¿”å›å€¼</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1644" data-line-end="1647" class="language-rust">rst.as_ref() <span class="hljs-comment">//è½¬ä¸ºResult&lt;&amp;T, &amp;E&gt;</span>
rst.as_mut() <span class="hljs-comment">//è½¬ä¸ºResult&lt;&amp;mut T, &amp;mut E&gt;</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1649" data-line-end="1656" class="language-rust"><span class="hljs-keyword">if</span> rst.is_ok() {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, rst.unwrap());
}
<span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, rst.err().unwrap()); <span class="hljs-comment">//unwrapä¹Ÿé€‚ç”¨äºOption&lt;T&gt;</span>
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1657" data-line-end="1659">Result&lt;T, E&gt;çš„åˆ«å</li>
</ul>
<pre><code class="has-line-data" data-line-start="1660" data-line-end="1662" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">type</span> <span class="hljs-title">Result</span>&lt;T&gt; = <span class="hljs-built_in">Result</span>&lt;T, Error&gt;;
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1663" data-line-end="1665">æ ‡å‡†åº“ä¸­å®šä¹‰çš„Error</li>
</ul>
<pre><code class="has-line-data" data-line-start="1666" data-line-end="1671" class="language-rust">std::io::Error
std::fmt::Error
std::str::Utf8Error
<span class="hljs-comment">//æ ¸å¿ƒæ˜¯std::error::Error</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1673" data-line-end="1678" class="language-rust"><span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, err); <span class="hljs-comment">//ç®€è¦ä¿¡æ¯</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, err); <span class="hljs-comment">//è¯¦ç»†ä¿¡æ¯</span>
err.to_string()
err.source() <span class="hljs-comment">//è¿”å›Option&lt;E&gt;ï¼Œè¡¨ç¤ºé”™è¯¯å‘ç”Ÿçš„æºé”™è¯¯ï¼Œä¸å­˜åœ¨åˆ™None</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1679" data-line-end="1683">
<p class="has-line-data" data-line-start="1679" data-line-end="1680">é”™è¯¯çš„ä¼ æ’­</p>
<p class="has-line-data" data-line-start="1681" data-line-end="1682">æ‰€åœ¨çš„å‡½æ•°è¿”å›å€¼ç±»å‹ä¸ºResult&lt;T, E&gt;ï¼Œä¸”errç±»å‹ä¸ºE</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1684" data-line-end="1689" class="language-rust"><span class="hljs-keyword">let</span> v = <span class="hljs-keyword">match</span> f() {
    <span class="hljs-built_in">Ok</span>(suc) =&gt; suc,
    <span class="hljs-built_in">Err</span>(err) =&gt; <span class="hljs-keyword">return</span> <span class="hljs-built_in">Err</span>(err)
};
</code></pre>
<pre><code class="has-line-data" data-line-start="1691" data-line-end="1693" class="language-rust"><span class="hljs-keyword">let</span> v = f()?;
</code></pre>
<h3 class="code-line" data-line-start=1694 data-line-end=1695 ><a id="07_Crates_and_Modules_1694"></a>07 Crates and Modules</h3>
<h5 class="code-line" data-line-start=1696 data-line-end=1697 ><a id="Crate_1696"></a>Crate</h5>
<ul>
<li class="has-line-data" data-line-start="1698" data-line-end="1699">ç”±moduleæ„æˆçš„æ ‘</li>
<li class="has-line-data" data-line-start="1699" data-line-end="1700">Library crateç¼–è¯‘åå¾—åˆ°åº“æ–‡ä»¶ï¼ŒBinary crateç¼–è¯‘åå¾—åˆ°å¯æ‰§è¡Œç¨‹åº</li>
<li class="has-line-data" data-line-start="1700" data-line-end="1702">crate rootï¼šå¯¹crateè¿›è¡Œç¼–è¯‘çš„èµ·ç‚¹</li>
</ul>
<pre><code class="has-line-data" data-line-start="1703" data-line-end="1706">cargo new //åˆ›å»ºçš„é¡¹ç›®ç¼ºçœä»…åŒ…å«ä¸€ä¸ªbinary crate
cargo build --verbose //ç¼–è¯‘è¿‡ç¨‹ç»†èŠ‚
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1707" data-line-end="1709"><a href="http://xn--main-4h0gl8cigp36k.xn--rslib-sn9h.rs">åŒæ—¶åŒ…å«main.rså’Œlib.rs</a></li>
</ul>
<pre><code class="has-line-data" data-line-start="1710" data-line-end="1712" class="language-rust"><span class="hljs-keyword">let</span> c = crate_main_lib::add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="1714" data-line-end="1717" class="language-rust"><span class="hljs-keyword">use</span> crate_main_lib::add;
<span class="hljs-keyword">let</span> c = add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="1719" data-line-end="1722" class="language-rust"><span class="hljs-keyword">use</span> crate_main_lib::add <span class="hljs-keyword">as</span> plus;
<span class="hljs-keyword">let</span> c = add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1723" data-line-end="1727">
<p class="has-line-data" data-line-start="1723" data-line-end="1724">ä¸€ä¸ªlib crateå…³è”å¤šä¸ªbinary crates</p>
<p class="has-line-data" data-line-start="1725" data-line-end="1726">./src/binä¸‹çš„æ¯ä¸€ä¸ªrsæ–‡ä»¶æ˜¯ä¸€ä¸ªbinary crateçš„root</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1728" data-line-end="1730">cargo run --bin file_name
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1731" data-line-end="1733">ä¸¤ä¸ªæœ¬åœ°cratesä¹‹é—´å»ºç«‹ä¾èµ–å…³ç³»</li>
</ul>
<pre><code class="has-line-data" data-line-start="1734" data-line-end="1737" class="language-toml"><span class="hljs-title">[dependencies]</span>
<span class="hljs-setting">calc = <span class="hljs-value">{ path = <span class="hljs-string">"../calc"</span> }</span></span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1739" data-line-end="1741" class="language-rust"><span class="hljs-keyword">use</span> calc::add;
</code></pre>
<h5 class="code-line" data-line-start=1742 data-line-end=1743 ><a id="module_1742"></a>module</h5>
<ul>
<li class="has-line-data" data-line-start="1744" data-line-end="1746">
<p class="has-line-data" data-line-start="1744" data-line-end="1745">a collection of items</p>
</li>
<li class="has-line-data" data-line-start="1746" data-line-end="1748">
<p class="has-line-data" data-line-start="1746" data-line-end="1747">itemsï¼šfunctionã€typeã€moduleã€constantâ€¦â€¦</p>
</li>
<li class="has-line-data" data-line-start="1748" data-line-end="1760">
<p class="has-line-data" data-line-start="1748" data-line-end="1749">å¯è§æ€§</p>
<p class="has-line-data" data-line-start="1750" data-line-end="1751">privateï¼šå½“å‰åŠåä»£æ¨¡å—å†…</p>
<p class="has-line-data" data-line-start="1752" data-line-end="1753">pub(crate)ï¼šå½“å‰crateå†…</p>
<p class="has-line-data" data-line-start="1754" data-line-end="1755">pubï¼šå½“å‰æ¨¡å—å†…å¤–</p>
<p class="has-line-data" data-line-start="1756" data-line-end="1757">pub(super)ï¼šçˆ¶æ¨¡å—åŠåä»£æ¨¡å—å†…</p>
<p class="has-line-data" data-line-start="1758" data-line-end="1759">pub(in &lt;path&gt;)ï¼šä¸€ä¸ªç¥–å…ˆæ¨¡å—åŠåä»£æ¨¡å—å†…</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1761" data-line-end="1767" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> arith {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> simple {
        <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">add</span></span>(a: <span class="hljs-keyword">i32</span>, b: <span class="hljs-keyword">i32</span>) -&gt; <span class="hljs-keyword">i32</span> { a + b }
    }
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1768" data-line-end="1770">å½“å‰ï¼šselfï¼›çˆ¶ï¼šsuperï¼›æ ¹ï¼šcrate</li>
</ul>
<pre><code class="has-line-data" data-line-start="1771" data-line-end="1777" class="language-rust">super::simple::add
crate::arith::simple::add
arith::simple::add <span class="hljs-comment">//å½“å‰</span>
self::arith::simple::add <span class="hljs-comment">//æ°¸è¿œæŒ‡å‘äº²å…„å¼Ÿ</span>
::arith::simple::add <span class="hljs-comment">//å¤–éƒ¨crate</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1778" data-line-end="1780">useè¯­å¥</li>
</ul>
<pre><code class="has-line-data" data-line-start="1781" data-line-end="1793" class="language-rust">add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">//ok</span>
<span class="hljs-keyword">use</span> self::arith::simple::add;
add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">//ok</span>
{
    add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">//ok</span>
    <span class="hljs-keyword">mod</span> inner {
        <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>() -&gt; <span class="hljs-keyword">i32</span> {
            add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">//errorï¼Œä»£ç å—ä¸­å®šä¹‰çš„æ¨¡å—æ— æ³•ä½¿ç”¨useå¼•å…¥çš„åˆ«å</span>
        }
    }
}
</code></pre>
<pre><code class="has-line-data" data-line-start="1795" data-line-end="1808" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> a {
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>() -&gt; <span class="hljs-keyword">i32</span> {
        super::b::add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
        crate::b::add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
        crate::add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
    }
}
add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">//ok</span>
<span class="hljs-keyword">use</span> self::b::add;
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> b {
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">add</span></span>() {}
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1809" data-line-end="1811">ä¸€æ¡useè¯­å¥å¼•å…¥å¤šä¸ªitems</li>
</ul>
<pre><code class="has-line-data" data-line-start="1812" data-line-end="1816" class="language-rust"><span class="hljs-keyword">use</span> std::collections::{HashMap, HashSet};
<span class="hljs-keyword">use</span> std::fs::{<span class="hljs-keyword">self</span>, File};
<span class="hljs-keyword">use</span> std::io::prelude::*; <span class="hljs-comment">//æ‰€æœ‰å¯è§çš„items</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1817" data-line-end="1819">pub use</li>
</ul>
<pre><code class="has-line-data" data-line-start="1820" data-line-end="1830" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> a {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> b {
        <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">add</span></span>() {}
        <span class="hljs-keyword">pub</span>(<span class="hljs-keyword">crate</span>) <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">add</span></span>() {} <span class="hljs-comment">//errorï¼Œre-exportingä¸èƒ½ä¸itemå¯è§æ€§å†²çª</span>
    }
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">use</span> self::b::add; <span class="hljs-comment">//re-exports the item add</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>() -&gt; <span class="hljs-keyword">i32</span> { add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) }
}
<span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>() -&gt; <span class="hljs-keyword">i32</span> { self::a::add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) }
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1831" data-line-end="1835">
<p class="has-line-data" data-line-start="1831" data-line-end="1832">ä¸€ä¸ªcrateæ”¾åœ¨å¤šä¸ªæ–‡ä»¶ä¸­</p>
<p class="has-line-data" data-line-start="1833" data-line-end="1834">å››ç§å­˜æ”¾æ–¹å¼ï¼šembedã€single fileã€file+dirã€dir</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1836" data-line-end="1840" class="language-rust"><span class="hljs-comment">// main.rs</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() {}
<span class="hljs-keyword">mod</span> calc;
</code></pre>
<pre><code class="has-line-data" data-line-start="1842" data-line-end="1845" class="language-rust"><span class="hljs-comment">// ./calc.rs ./calc/mod.rs</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> arith;
</code></pre>
<pre><code class="has-line-data" data-line-start="1847" data-line-end="1850" class="language-rust"><span class="hljs-comment">// ./calc/arith.rs ./calc/arith/mod.rs</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> simple;
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1851" data-line-end="1852">é¢„å…ˆimportsçš„itemsï¼šstdã€std::prelude::*</li>
<li class="has-line-data" data-line-start="1852" data-line-end="1854">æ§åˆ¶Structä¸­Fieldçš„å¯è§æ€§</li>
</ul>
<pre><code class="has-line-data" data-line-start="1855" data-line-end="1868" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> a {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> b {
        <span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> C {
            <span class="hljs-keyword">pub</span> x: <span class="hljs-keyword">i32</span>,
            <span class="hljs-keyword">pub</span>(<span class="hljs-keyword">super</span>) y: <span class="hljs-keyword">i32</span>,
            z: <span class="hljs-keyword">i32</span>
        }
        <span class="hljs-comment">//x, y, z</span>
    }
    <span class="hljs-comment">//x, y</span>
}
<span class="hljs-comment">// x</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1869" data-line-end="1875">
<p class="has-line-data" data-line-start="1869" data-line-end="1870">åœ¨æ¨¡å—ä¸­å®šä¹‰staticå’Œconstant items</p>
<p class="has-line-data" data-line-start="1871" data-line-end="1872">constï¼šç±»ä¼¼#defineå®šä¹‰çš„å®å¸¸é‡ï¼Œä¸å­˜åœ¨mut</p>
<p class="has-line-data" data-line-start="1873" data-line-end="1874">staticï¼šä¸€ç§å˜é‡ï¼Œç”Ÿå­˜æœŸä¸ç¨‹åºç›¸åŒï¼Œå­˜åœ¨mutï¼ˆmut staticä¸å…·æœ‰çº¿ç¨‹å®‰å…¨æ€§ï¼Œåªèƒ½åœ¨unsafeä¸­ä½¿ç”¨ï¼‰</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1876" data-line-end="1881" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> a {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">const</span> C: <span class="hljs-keyword">f64</span> = <span class="hljs-number">1.0</span>;
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">static</span> F: <span class="hljs-keyword">f64</span> = <span class="hljs-number">2.0</span>;
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1882" data-line-end="1884">åœ¨itemä¸Šå£°æ˜attributes</li>
</ul>
<pre><code class="has-line-data" data-line-start="1885" data-line-end="1890" class="language-rust"><span class="hljs-keyword">mod</span> a {
    <span class="hljs-comment">//#[warn(dead_code)]</span>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>() {}
}
</code></pre>
<pre><code class="has-line-data" data-line-start="1892" data-line-end="1897" class="language-rust"><span class="hljs-keyword">mod</span> a {
    <span class="hljs-preprocessor">#[allow(dead_code)]</span>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>() {}
}
</code></pre>
<pre><code class="has-line-data" data-line-start="1899" data-line-end="1901" class="language-rust"><span class="hljs-preprocessor">#[cfg(...)]</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1903" data-line-end="1907" class="language-rust"><span class="hljs-preprocessor">#[inline]</span>
<span class="hljs-preprocessor">#[inline(always)]</span>
<span class="hljs-preprocessor">#[inline(never)]</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1909" data-line-end="1911" class="language-rust"><span class="hljs-preprocessor">#![allow(dead_code)]</span> <span class="hljs-comment">//ä½œç”¨åˆ°æ‰€æœ‰åä»£æ¨¡å—çš„æ‰€æœ‰ç›¸å…³ç¨‹åºå…ƒç´ </span>
</code></pre>
<pre><code class="has-line-data" data-line-start="1913" data-line-end="1917" class="language-rust"><span class="hljs-preprocessor">#[test]</span>
<span class="hljs-preprocessor">#[inline]</span> <span class="hljs-comment">//ä¸èƒ½#![]</span>
<span class="hljs-preprocessor">#![feature(...)]</span> <span class="hljs-comment">//åªèƒ½#![]</span>
</code></pre>
<h5 class="code-line" data-line-start=1918 data-line-end=1919 ><a id="_1918"></a>æ·»åŠ å•å…ƒæµ‹è¯•ä»£ç </h5>
<pre><code class="has-line-data" data-line-start="1921" data-line-end="1924">cargo new unit_test --lib
cargo test
</code></pre>
<pre><code class="has-line-data" data-line-start="1926" data-line-end="1935" class="language-rust"><span class="hljs-preprocessor">#[cfg(test)]</span>
<span class="hljs-keyword">mod</span> tests {
    <span class="hljs-preprocessor">#[test]</span>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">it_works</span></span>() {
        <span class="hljs-keyword">let</span> result = <span class="hljs-number">2</span> + <span class="hljs-number">2</span>;
        <span class="hljs-built_in">assert_eq!</span>(result, <span class="hljs-number">4</span>);
    }
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1936" data-line-end="1940">
<p class="has-line-data" data-line-start="1936" data-line-end="1937">å¸¸ç”¨çš„ä¸¤ä¸ªå®</p>
<p class="has-line-data" data-line-start="1938" data-line-end="1939">åœ¨éæµ‹è¯•ä»£ç ä¸­å¯ä»¥ä½¿ç”¨ï¼Œä¼šè¢«ç¼–è¯‘åˆ°releaseä¸­ï¼Œå¸¦debugå‰ç¼€åªåœ¨debugæœ‰æ•ˆ</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="1941" data-line-end="1944" class="language-rust"><span class="hljs-built_in">assert!</span>();
<span class="hljs-built_in">assert_eq!</span>();
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1945" data-line-end="1947">æµ‹è¯•ä¸€å®šä¼španic</li>
</ul>
<pre><code class="has-line-data" data-line-start="1948" data-line-end="1956" class="language-rust"><span class="hljs-preprocessor">#[test]</span>
<span class="hljs-preprocessor">#[should_panic(expected="divide by zero")]</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>() {
    <span class="hljs-keyword">let</span> a = <span class="hljs-keyword">if</span> <span class="hljs-number">2</span> &gt; <span class="hljs-number">3</span> {<span class="hljs-number">1</span>} <span class="hljs-keyword">else</span> {<span class="hljs-number">1</span>};
    <span class="hljs-keyword">let</span> b = <span class="hljs-keyword">if</span> a &gt; <span class="hljs-number">0</span> {<span class="hljs-number">0</span>} <span class="hljs-keyword">else</span> {<span class="hljs-number">0</span>};
    <span class="hljs-keyword">let</span> c = a / b;
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1957" data-line-end="1959">è¿”å›Result&lt;(), E&gt;</li>
</ul>
<pre><code class="has-line-data" data-line-start="1960" data-line-end="1966" class="language-rust"><span class="hljs-preprocessor">#[test]</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>() -&gt; <span class="hljs-built_in">Result</span>&lt;(), ParseIntError&gt; {
    i32::from_str_radix(<span class="hljs-string">"a11"</span>, <span class="hljs-number">10</span>)?;
    <span class="hljs-built_in">Ok</span>(())
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1967" data-line-end="1969">é€‰æ‹©æµ‹è¯•å‡½æ•°</li>
</ul>
<pre><code class="has-line-data" data-line-start="1970" data-line-end="1972">cargo test f
</code></pre>
<h5 class="code-line" data-line-start=1973 data-line-end=1974 ><a id="_1973"></a>æ·»åŠ é›†æˆæµ‹è¯•ä»£ç </h5>
<ul>
<li class="has-line-data" data-line-start="1975" data-line-end="1977">æ”¾åœ¨./tests/ç›®å½•ä¸‹ï¼Œæ¯ä¸€ä¸ªrsæ–‡ä»¶è§†ä¸ºä¸€ä¸ªcrate</li>
</ul>
<pre><code class="has-line-data" data-line-start="1978" data-line-end="1981" class="language-rust"><span class="hljs-comment">// ./tests/test_1.rs</span>
<span class="hljs-keyword">use</span> inte_test::calc::add;
</code></pre>
<h5 class="code-line" data-line-start=1982 data-line-end=1983 ><a id="_1982"></a>æ·»åŠ è¯´æ˜æ–‡å­—</h5>
<pre><code class="has-line-data" data-line-start="1985" data-line-end="1990" class="language-rust"><span class="hljs-preprocessor">#![doc = "hello"]</span>

<span class="hljs-preprocessor">#[doc = "hello"]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> a {}
</code></pre>
<pre><code class="has-line-data" data-line-start="1992" data-line-end="1994">cargo doc --no-deps --open
</code></pre>
<ul>
<li class="has-line-data" data-line-start="1995" data-line-end="1997">doc attrçš„è¯­æ³•ç³–</li>
</ul>
<pre><code class="has-line-data" data-line-start="1998" data-line-end="2001" class="language-rust"><span class="hljs-comment">/// hello</span>
<span class="hljs-comment">//! hello</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2002" data-line-end="2004">åœ¨docæ·»åŠ ä»£ç å—</li>
</ul>
<pre><code class="has-line-data" data-line-start="2005" data-line-end="2010" class="language-rust"><span class="hljs-comment">/// code</span>
<span class="hljs-comment">///</span>
<span class="hljs-comment">///     println!("hello");</span>
<span class="hljs-comment">///     </span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2012" data-line-end="2017" class="language-rust"><span class="hljs-comment">/// code</span>
<span class="hljs-comment">/// '''</span>
<span class="hljs-comment">/// println!("hello");</span>
<span class="hljs-comment">/// '''</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2018" data-line-end="2020">æŒ‡å®šä»£ç è¡Œä¸å‡ºç°åœ¨docæ–‡æ¡£</li>
</ul>
<pre><code class="has-line-data" data-line-start="2021" data-line-end="2026" class="language-rust"><span class="hljs-comment">/// code</span>
<span class="hljs-comment">/// '''</span>
<span class="hljs-comment">/// # println!("hello");</span>
<span class="hljs-comment">/// '''</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2027" data-line-end="2029">docä¸­ä»£ç å—è¢«ç¼–è¯‘ä¸ºæµ‹è¯•å‡½æ•°</li>
</ul>
<pre><code class="has-line-data" data-line-start="2030" data-line-end="2035" class="language-rust"><span class="hljs-comment">/// code</span>
<span class="hljs-comment">/// '''ignore //ä¸ç¼–è¯‘è¿è¡Œ</span>
<span class="hljs-comment">/// println!("hello");</span>
<span class="hljs-comment">/// '''</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2037" data-line-end="2042" class="language-rust"><span class="hljs-comment">/// code</span>
<span class="hljs-comment">/// '''no_run //ç¼–è¯‘ï¼Œä¸è¿è¡Œ</span>
<span class="hljs-comment">/// println!("hello");</span>
<span class="hljs-comment">/// '''</span>
</code></pre>
<h5 class="code-line" data-line-start=2043 data-line-end=2044 ><a id="cargo_2043"></a>åœ¨cargoé¡¹ç›®ä¸­å£°æ˜å¤–éƒ¨ä¾èµ–</h5>
<ul>
<li class="has-line-data" data-line-start="2045" data-line-end="2047">å¤–éƒ¨crateæ”¾åœ¨æœ¬åœ°é¡¹ç›®ä¸­</li>
</ul>
<pre><code class="has-line-data" data-line-start="2048" data-line-end="2051" class="language-toml"><span class="hljs-title">[dependencies]</span>
<span class="hljs-setting">util = <span class="hljs-value">{ path = <span class="hljs-string">"util"</span> }</span></span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2053" data-line-end="2056" class="language-toml"><span class="hljs-title">[dependencies]</span>
<span class="hljs-setting">calc = <span class="hljs-value">{ path = <span class="hljs-string">"../calc"</span> }</span></span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2057" data-line-end="2059">å¤–éƒ¨crateæ”¾åœ¨è¿œç¨‹gitä»“åº“ä¸­</li>
</ul>
<pre><code class="has-line-data" data-line-start="2060" data-line-end="2063" class="language-toml"><span class="hljs-title">[dependencies]</span>
<span class="hljs-setting">regex = <span class="hljs-value">{ git = <span class="hljs-string">"https://github.com/rust-lang/regex"</span> }</span></span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2065" data-line-end="2068" class="language-toml"><span class="hljs-title">[dependencies]</span>
<span class="hljs-setting">regex = <span class="hljs-value">{ git = <span class="hljs-string">"https://github.com/rust-lang/regex"</span>, branch = <span class="hljs-string">"next"</span>}</span></span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2069" data-line-end="2071">å¤–éƒ¨crateæ”¾åœ¨crates.ioä¸Š</li>
</ul>
<pre><code class="has-line-data" data-line-start="2072" data-line-end="2075" class="language-toml"><span class="hljs-title">[dependencies]</span>
<span class="hljs-setting">image = <span class="hljs-value"><span class="hljs-string">"0.13.0"</span> //è€ƒè™‘å¤šæ–¹éœ€æ±‚ï¼Œæ‰¾åˆ°ä¸<span class="hljs-number">0.13</span>.<span class="hljs-number">0</span>å…¼å®¹çš„å°½å¯èƒ½æ–°çš„ç‰ˆæœ¬</span></span>
</code></pre>
<h5 class="code-line" data-line-start=2076 data-line-end=2077 ><a id="_2076"></a>ç‰ˆæœ¬å·ç®¡ç†</h5>
<ul>
<li class="has-line-data" data-line-start="2078" data-line-end="2086">
<p class="has-line-data" data-line-start="2078" data-line-end="2079">Major.Minor.Patch</p>
<p class="has-line-data" data-line-start="2080" data-line-end="2081">Major/ä¸»ç‰ˆæœ¬å·ï¼šä¸å…·å…¼å®¹æ€§æ”¹å˜</p>
<p class="has-line-data" data-line-start="2082" data-line-end="2083">Minor/æ¬¡ç‰ˆæœ¬å·ï¼šå…·æœ‰å…¼å®¹æ€§çš„å¢å¼º</p>
<p class="has-line-data" data-line-start="2084" data-line-end="2085">Patch/ä¿®è®¢å·ï¼šä¿®å¤</p>
</li>
<li class="has-line-data" data-line-start="2086" data-line-end="2094">
<p class="has-line-data" data-line-start="2086" data-line-end="2087">å…¼å®¹æ€§åˆ¤æ–­</p>
<p class="has-line-data" data-line-start="2088" data-line-end="2089">ä¸¤ä¸ª0.0å‰ç¼€ä¸å­˜åœ¨å…¼å®¹å…³ç³»</p>
<p class="has-line-data" data-line-start="2090" data-line-end="2091">ä¸¤ä¸ªç›¸åŒ0.xï¼ˆxé0ï¼‰å­˜åœ¨å…¼å®¹å…³ç³»</p>
<p class="has-line-data" data-line-start="2092" data-line-end="2093">ä¸»ç‰ˆæœ¬å·ç›¸åŒå…·æœ‰å…¼å®¹å…³ç³»</p>
</li>
<li class="has-line-data" data-line-start="2094" data-line-end="2112">
<p class="has-line-data" data-line-start="2094" data-line-end="2095">Caret requirements</p>
<p class="has-line-data" data-line-start="2096" data-line-end="2097">^0ï¼š[0.0.0, 1.0.0)ï¼Œä¸å…¼å®¹</p>
<p class="has-line-data" data-line-start="2098" data-line-end="2099">^0.0ï¼š[0.0.0, 0.1.0)ï¼Œä¸å…¼å®¹</p>
<p class="has-line-data" data-line-start="2100" data-line-end="2101">^0.0.3ï¼š[0.0.3, 0.0.4)ï¼Œä¸é€‚ç”¨</p>
<p class="has-line-data" data-line-start="2102" data-line-end="2103">^0.2ï¼š[0.2.0, 0.3.0)ï¼Œå…¼å®¹</p>
<p class="has-line-data" data-line-start="2104" data-line-end="2105">^0.2.3ï¼š[0.2.3, 0.3.0)ï¼Œå…¼å®¹</p>
<p class="has-line-data" data-line-start="2106" data-line-end="2107">^1ï¼š[1.0.0, 2.0.0)ï¼Œå…¼å®¹</p>
<p class="has-line-data" data-line-start="2108" data-line-end="2109">^1.2ï¼š[1.2.0, 2.0.0)ï¼Œå…¼å®¹</p>
<p class="has-line-data" data-line-start="2110" data-line-end="2111">^1.2.3: [1.2.3, 2.0.0)ï¼Œå…¼å®¹</p>
</li>
<li class="has-line-data" data-line-start="2112" data-line-end="2114">
<p class="has-line-data" data-line-start="2112" data-line-end="2113">Tilde requirementsï¼š<sub>1ã€</sub>1.2ã€~1.2.3</p>
</li>
<li class="has-line-data" data-line-start="2114" data-line-end="2122">
<p class="has-line-data" data-line-start="2114" data-line-end="2115">Other requirements</p>
<p class="has-line-data" data-line-start="2116" data-line-end="2117">Wildcardï¼š*ã€1.*ã€1.2.*</p>
<p class="has-line-data" data-line-start="2118" data-line-end="2119">Comparisonï¼š&gt;=1.2.0ã€&lt;2ã€=1.2.3</p>
<p class="has-line-data" data-line-start="2120" data-line-end="2121">Combinationï¼š&gt;=2, &lt; 1.5</p>
</li>
<li class="has-line-data" data-line-start="2122" data-line-end="2124">
<p class="has-line-data" data-line-start="2122" data-line-end="2123">Cargo.lockè®°å½•å½“å‰é¡¹ç›®ç›´æ¥/é—´æ¥ä¾èµ–çš„å¤–éƒ¨cratesæ¥æºä¸çœŸå®ç‰ˆæœ¬ï¼Œæœ¬åœ°ç¼“å­˜ï¼Œä¾›æ‰€æœ‰Cargoé¡¹ç›®å¤ç”¨</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="2125" data-line-end="2127">cargo update //é‡æ–°è®¡ç®—
</code></pre>
<h5 class="code-line" data-line-start=2128 data-line-end=2129 ><a id="cratecratesio_2128"></a><a href="http://xn--cratecrates-cn7rq5d15jx97bpiak71ee08f897ax2l.io">æŠŠè‡ªå·±ç¼–å†™çš„crateå‘å¸ƒåˆ°crates.io</a></h5>
<pre><code class="has-line-data" data-line-start="2131" data-line-end="2135">cargo package
cargo login &lt;key&gt;
cargo publish
</code></pre>
<h5 class="code-line" data-line-start=2136 data-line-end=2137 ><a id="workspace_2136"></a>æŠŠé¡¹ç›®ç»„ç»‡ä¸ºworkspace</h5>
<ul>
<li class="has-line-data" data-line-start="2138" data-line-end="2140">åœ¨æ‰€æœ‰cargoé¡¹ç›®çš„ä¸Šå±‚ç›®å½•åˆ›å»ºCargo.tomlæ–‡ä»¶ï¼Œåˆ é™¤æ¯ä¸€ä¸ªcarogé¡¹ç›®ä¸­çš„Cargo.lockå’Œtargetç›®å½•</li>
</ul>
<pre><code class="has-line-data" data-line-start="2141" data-line-end="2144" class="language-toml"><span class="hljs-title">[workspace]</span>
<span class="hljs-setting">members = <span class="hljs-value">[<span class="hljs-string">"crate_1"</span>, <span class="hljs-string">"crate_2"</span>]</span></span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2146" data-line-end="2148">cargo build --workspace
</code></pre>
<h3 class="code-line" data-line-start=2149 data-line-end=2150 ><a id="08__2149"></a>08 ç»“æ„ä½“</h3>
<h5 class="code-line" data-line-start=2151 data-line-end=2152 ><a id="NamedField_Struct_2151"></a>Named-Field Struct</h5>
<pre><code class="has-line-data" data-line-start="2154" data-line-end="2163" class="language-rust"><span class="hljs-keyword">struct</span> Image {
    size: (usize, usize),
    pixels: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u32</span>&gt;
}
<span class="hljs-keyword">let</span> im = Image {
    pixels: <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>; w * h],
    size: (w, h)
};
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2164" data-line-end="2166">ä¸€ä¸ªè¯­æ³•ç³–</li>
</ul>
<pre><code class="has-line-data" data-line-start="2167" data-line-end="2171" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">new</span></span>(size: (usize, usize), pixels: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u32</span>&gt;) -&gt; Image {
    Image { size, pixels }
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2172" data-line-end="2174">å¯è§æ€§ï¼Œç¼ºçœä¸ºprivate</li>
</ul>
<pre><code class="has-line-data" data-line-start="2175" data-line-end="2180" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> Image {
    <span class="hljs-keyword">pub</span> size: (usize, usize),
    <span class="hljs-keyword">pub</span> pixels: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u32</span>&gt;
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2181" data-line-end="2185">
<p class="has-line-data" data-line-start="2181" data-line-end="2182">partially moved</p>
<p class="has-line-data" data-line-start="2183" data-line-end="2184">å…¶ä»–fieldä»ç„¶å¯ä»¥æ­£å¸¸è®¿é—®ï¼Œè‡ªèº«çš„æ‰€æœ‰æƒä¸èƒ½å†è¢«è½¬ç§»</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="2186" data-line-end="2195" class="language-rust"><span class="hljs-keyword">let</span> a = A {
    x: String::from(<span class="hljs-string">"hello"</span>),
    y: String::from(<span class="hljs-string">"world"</span>),
    n: <span class="hljs-number">1</span>
};
<span class="hljs-keyword">let</span> s = a.x;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, a.n); <span class="hljs-comment">//ok</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, a); <span class="hljs-comment">//error</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2196" data-line-end="2198">ç¼ºçœå€¼è¡¨è¾¾å¼</li>
</ul>
<pre><code class="has-line-data" data-line-start="2199" data-line-end="2205" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(a: A) -&gt; (A, A) {
    <span class="hljs-keyword">let</span> a1 = A { n: a.n + <span class="hljs-number">1</span>, ..a };
    <span class="hljs-keyword">let</span> a2 = A { x: a1.x.clone(), y: a1.y.clone(), ..a1 };
    (a1, a2)
}
</code></pre>
<h5 class="code-line" data-line-start=2206 data-line-end=2207 ><a id="TupleLike_Struct_2206"></a>Tuple-Like Struct</h5>
<pre><code class="has-line-data" data-line-start="2209" data-line-end="2214" class="language-rust"><span class="hljs-keyword">struct</span> Bound(usize, usize);
<span class="hljs-keyword">let</span> b = Bound(<span class="hljs-number">1024</span>, <span class="hljs-number">768</span>);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}, {}"</span>, b.<span class="hljs-number">0</span>, b.<span class="hljs-number">1</span>);
<span class="hljs-keyword">let</span> Bound (b0, b1) = b;
</code></pre>
<h5 class="code-line" data-line-start=2215 data-line-end=2216 ><a id="UnitLike_Struct_2215"></a>Unit-Like Struct</h5>
<pre><code class="has-line-data" data-line-start="2218" data-line-end="2223" class="language-rust"><span class="hljs-preprocessor">#[derive(Debug)]</span>
<span class="hljs-keyword">struct</span> OneSuch;
<span class="hljs-keyword">let</span> o = OneSuch;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, o);
</code></pre>
<h5 class="code-line" data-line-start=2224 data-line-end=2225 ><a id="impl_2224"></a>é€šè¿‡implä»£ç å—æ·»åŠ æ–¹æ³•</h5>
<ul>
<li class="has-line-data" data-line-start="2226" data-line-end="2228">å†—ä½™ç‰ˆæœ¬</li>
</ul>
<pre><code class="has-line-data" data-line-start="2229" data-line-end="2241" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> Queue {}
<span class="hljs-keyword">impl</span> Queue {
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">new</span></span>() -&gt; Queue {}
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_empty</span></span>(<span class="hljs-keyword">self</span>: &amp;Queue) -&gt; <span class="hljs-keyword">bool</span> {}
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">push</span></span>(<span class="hljs-keyword">self</span>: &amp;<span class="hljs-keyword">mut</span> Queue, c: <span class="hljs-keyword">char</span>) {}
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">pop</span></span>(<span class="hljs-keyword">self</span>: &amp;<span class="hljs-keyword">mut</span> Queue) -&gt; <span class="hljs-built_in">Option</span>&lt;<span class="hljs-keyword">char</span>&gt; {}
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">split</span></span>(<span class="hljs-keyword">self</span>: Queue) -&gt; (<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">char</span>&gt;, <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">char</span>&gt;) {}
}

<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> q = Queue::new();
Queue::push(&amp;<span class="hljs-keyword">mut</span> q, <span class="hljs-string">'a'</span>);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2242" data-line-end="2244">ç®€æ´ç‰ˆæœ¬</li>
</ul>
<pre><code class="has-line-data" data-line-start="2245" data-line-end="2256" class="language-rust"><span class="hljs-keyword">impl</span> Queue {
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">new</span></span>() -&gt; <span class="hljs-keyword">Self</span> {}
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_empty</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-keyword">bool</span> {}
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">push</span></span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>, c: <span class="hljs-keyword">char</span>) {}
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">pop</span></span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">Option</span>&lt;<span class="hljs-keyword">char</span>&gt; {}
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">split</span></span>(<span class="hljs-keyword">self</span>) -&gt; (<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">char</span>&gt;, <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">char</span>&gt;) {}
}

<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> q = Queue::new()
q.push(<span class="hljs-string">'a'</span>) <span class="hljs-comment">//dotæ“ä½œç¬¦çŸ¥é“å·¦è¾¹å–ä»€ä¹ˆå½¢å¼çš„å€¼</span>
</code></pre>
<h5 class="code-line" data-line-start=2257 data-line-end=2258 ><a id="dot_2257"></a>dotæ“ä½œ</h5>
<ul>
<li class="has-line-data" data-line-start="2259" data-line-end="2261">ç”¨åˆ°Box</li>
</ul>
<pre><code class="has-line-data" data-line-start="2262" data-line-end="2268" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> bq = Box::new(Queue::new());

bq.push(<span class="hljs-string">'a'</span>);  <span class="hljs-comment">//ä»mut Box&lt;Queue&gt;ä¸­è·å¾—&amp;mut Queueï¼Œè·å¾—æ–¹å¼&amp;mut *bq</span>
bq.is_empty(); <span class="hljs-comment">//è·å¾—æ–¹å¼&amp;*bq</span>
bq.split(); <span class="hljs-comment">//*bqå‘ç”Ÿæ‰€æœ‰æƒè½¬ç§»</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2269" data-line-end="2271">ç”¨åˆ°Rc</li>
</ul>
<pre><code class="has-line-data" data-line-start="2272" data-line-end="2278" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> q = Queue::new();
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> cq = Rc::new(q); <span class="hljs-comment">//q is removed</span>
cq.is_empty(); <span class="hljs-comment">//è·å¾—æ–¹å¼&amp;*cq</span>
cq.push(<span class="hljs-string">'a'</span>); <span class="hljs-comment">//errorï¼Œè¢«RCæ‹¥æœ‰çš„å€¼is immutable</span>
cq.split(); <span class="hljs-comment">//errorï¼Œcannot move out of an Rc</span>
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2279" data-line-end="2281">Rcçš„ä¸¤ä¸ªé«˜çº§å‡½æ•°</li>
</ul>
<pre><code class="has-line-data" data-line-start="2282" data-line-end="2292" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">get_mut</span></span>(this: &amp;<span class="hljs-keyword">mut</span> Rc&lt;T&gt;) -&gt; <span class="hljs-built_in">Option</span>&lt;&amp;<span class="hljs-keyword">mut</span> T&gt; {
    <span class="hljs-keyword">if</span> Rc::is_unique(this) { <span class="hljs-keyword">unsafe</span> { <span class="hljs-built_in">Some</span>(Rc::get_mut_unchecked(this)) } } <span class="hljs-keyword">else</span> { <span class="hljs-built_in">None</span> }
}

<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> x = Rc::new(<span class="hljs-number">3</span>);
*Rc::get_mut(&amp;<span class="hljs-keyword">mut</span> x).unwrap() = <span class="hljs-number">4</span>;
<span class="hljs-built_in">assert_eq!</span>(*x, <span class="hljs-number">4</span>);
<span class="hljs-keyword">let</span> y = Rc::clone(&amp;x);
<span class="hljs-built_in">assert!</span>(Rc::get_mut(&amp;<span class="hljs-keyword">mut</span> x).is_none());
</code></pre>
<pre><code class="has-line-data" data-line-start="2294" data-line-end="2315" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">try_unwrap</span></span>(this: Rc&lt;T&gt;) -&gt; <span class="hljs-built_in">Result</span>&lt;T, Rc&lt;T&gt;&gt; {
    <span class="hljs-keyword">if</span> Rc::strong_count(&amp;this) == <span class="hljs-number">1</span> {
        <span class="hljs-keyword">unsafe</span> {
            <span class="hljs-keyword">let</span> val = ptr::read(&amp;*this);
            this.inner().dec_strong();
            <span class="hljs-keyword">let</span> _weak = Weak { ptr: this.ptr };
            forget(this);
            <span class="hljs-built_in">Ok</span>(val)
        }
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">Err</span>(this)
    }
}

<span class="hljs-keyword">let</span> x = Rc::new(<span class="hljs-number">3</span>);
<span class="hljs-built_in">assert_eq!</span>(Rc::try_unwrap(x), <span class="hljs-built_in">Ok</span>(<span class="hljs-number">3</span>));

<span class="hljs-keyword">let</span> x = Rc::new(<span class="hljs-number">3</span>);
<span class="hljs-keyword">let</span> y = Rc::clone(&amp;x);
<span class="hljs-built_in">assert_eq!</span>(*Rc::try_unwrap(x).unwrap_err(), <span class="hljs-number">4</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="2317" data-line-end="2324" class="language-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> cq = Rc::new(Queue::new());
<span class="hljs-keyword">let</span> q = Rc::get_mut(&amp;<span class="hljs-keyword">mut</span> cq).unwrap(); <span class="hljs-comment">//q is a &amp;mut Queue</span>
q.push(<span class="hljs-string">'a'</span>);
q.is_empty();
<span class="hljs-keyword">let</span> q = Rc::try_unwrap(cq).unwrap(); <span class="hljs-comment">//cq is moved, q is a Queue</span>
<span class="hljs-keyword">let</span> (o, y) = q.split(); <span class="hljs-comment">//q is moved</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2326" data-line-end="2339" class="language-rust"><span class="hljs-keyword">struct</span> Node {
    tag: <span class="hljs-built_in">String</span>,
    children: <span class="hljs-built_in">Vec</span>&lt;Rc&lt;Node&gt;&gt;
}
<span class="hljs-keyword">impl</span> Node {
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">append_to</span></span>(<span class="hljs-keyword">self</span>: Rc&lt;<span class="hljs-keyword">Self</span>&gt;, parent: &amp;<span class="hljs-keyword">mut</span> Node) {
        parent.children.push(<span class="hljs-keyword">self</span>);
    }
}
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> p = Node::new(<span class="hljs-string">"p"</span>);
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> c = Rc::new(Node::new(<span class="hljs-string">"c"</span>));
c.append_to(&amp;<span class="hljs-keyword">mut</span> p); <span class="hljs-comment">//cçš„æ‰€æœ‰æƒè½¬ç§»åˆ°append_toï¼Œåˆè¢«è½¬ç§»åˆ°å‘é‡ä¸­</span>
</code></pre>
<h5 class="code-line" data-line-start=2340 data-line-end=2341 ><a id="impl_2340"></a>é€šè¿‡implä»£ç å—æ·»åŠ å¸¸é‡</h5>
<pre><code class="has-line-data" data-line-start="2343" data-line-end="2355" class="language-rust"><span class="hljs-preprocessor">#[derive(Debug)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> Vec2D {
    x: <span class="hljs-keyword">f32</span>,
    y: <span class="hljs-keyword">f32</span>
}
<span class="hljs-keyword">impl</span> Vec2D {
    <span class="hljs-keyword">const</span> NAME: &amp;<span class="hljs-string">'static</span> <span class="hljs-keyword">str</span> = <span class="hljs-string">"Vec2D"</span>;
    <span class="hljs-keyword">const</span> UNIT: <span class="hljs-keyword">Self</span> = <span class="hljs-keyword">Self</span> { x: <span class="hljs-number">1.0</span>, y:<span class="hljs-number">0.0</span> };
}
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, Vec2D::NAME);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, Vec2D::UNIT);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2356" data-line-end="2358">å¯å­˜åœ¨å¤šä¸ªimplä»£ç å—ï¼Œå¿…é¡»å‡ºç°åœ¨ç±»å‹æ‰€åœ¨crateä¸­</li>
</ul>
<h5 class="code-line" data-line-start=2358 data-line-end=2359 ><a id="Generic_Struct_2358"></a>Generic Struct</h5>
<pre><code class="has-line-data" data-line-start="2361" data-line-end="2368" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> Queue&lt;T&gt; {
    older: <span class="hljs-built_in">Vec</span>&lt;T&gt;,
    ynger: <span class="hljs-built_in">Vec</span>&lt;T&gt;
}
<span class="hljs-keyword">impl</span>&lt;T&gt; Queue&lt;T&gt; {}
<span class="hljs-keyword">impl</span> Queue&lt;<span class="hljs-keyword">f64</span>&gt; {}
</code></pre>
<h5 class="code-line" data-line-start=2369 data-line-end=2370 ><a id="Struct_with_lifetime_parameters_2369"></a>Struct with lifetime parameters</h5>
<pre><code class="has-line-data" data-line-start="2372" data-line-end="2377" class="language-rust"><span class="hljs-keyword">struct</span> Extrema&lt;<span class="hljs-string">'elt</span>&gt; {
    min: &amp;<span class="hljs-string">'elt</span> <span class="hljs-keyword">i32</span>, max: &amp;<span class="hljs-string">'elt</span> <span class="hljs-keyword">i32</span>
}
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">find_extrema</span></span>&lt;<span class="hljs-string">'s</span>&gt;(slice: &amp;<span class="hljs-string">'s</span> [<span class="hljs-keyword">i32</span>]) -&gt; Extrema&lt;<span class="hljs-string">'s</span>&gt; {}
</code></pre>
<h5 class="code-line" data-line-start=2378 data-line-end=2379 ><a id="Deriving_Common_Traits_for_Struct_2378"></a>Deriving Common Traits for Struct</h5>
<pre><code class="has-line-data" data-line-start="2381" data-line-end="2384" class="language-rust"><span class="hljs-preprocessor">#[derive(Copy, Clone, Debug, PartialEq)]</span>
<span class="hljs-keyword">struct</span> Point {}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2385" data-line-end="2386">Copyï¼šå£°æ˜ä¸ºcopy type</li>
<li class="has-line-data" data-line-start="2386" data-line-end="2387">Cloneï¼šé™„ç€cloneæ–¹æ³•</li>
<li class="has-line-data" data-line-start="2387" data-line-end="2388">Dubugï¼šå¯ä»¥é€šè¿‡println!(&quot;{:?}&quot;)æ‰“å°</li>
<li class="has-line-data" data-line-start="2388" data-line-end="2390">PartialEqï¼šå¯ä»¥é€šè¿‡ç›¸ç­‰æˆ–ä¸ç­‰æ“ä½œç¬¦åˆ¤æ–­</li>
</ul>
<h5 class="code-line" data-line-start=2390 data-line-end=2391 ><a id="Interior_Mutability_2390"></a>Interior Mutability</h5>
<ul>
<li class="has-line-data" data-line-start="2392" data-line-end="2394">Cell&lt;T&gt;</li>
</ul>
<pre><code class="has-line-data" data-line-start="2395" data-line-end="2408" class="language-rust"><span class="hljs-keyword">use</span> std::cell::Cell;
<span class="hljs-keyword">struct</span> S {
    regular: <span class="hljs-keyword">u8</span>,
    special: Cell&lt;<span class="hljs-keyword">u8</span>&gt;
}
<span class="hljs-keyword">let</span> s = S {
    regular: <span class="hljs-number">0</span>,
    special: Cell::new(<span class="hljs-number">1</span>)
};
s.regular = <span class="hljs-number">5</span>; <span class="hljs-comment">//error</span>
s.special.set(<span class="hljs-number">5</span>); <span class="hljs-comment">//ok, enables "interior mutability"</span>
<span class="hljs-built_in">assert_eq!</span>(s.special.get(), <span class="hljs-number">5</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="2410" data-line-end="2417" class="language-rust"><span class="hljs-comment">//impl&lt;T&gt;ï¼ˆå®šé•¿ç±»å‹Tï¼‰</span>
<span class="hljs-keyword">let</span> c = Cell::new(<span class="hljs-number">1</span>);
c.set(<span class="hljs-number">2</span>);
c1.swap(&amp;c2); <span class="hljs-comment">//äº¤æ¢å„è‡ªçš„å€¼</span>
<span class="hljs-keyword">let</span> x = c.replace(<span class="hljs-number">5</span>); <span class="hljs-comment">//ç½®æ¢æ‹¥æœ‰çš„å€¼ï¼Œè¿”å›æ—§å€¼</span>
<span class="hljs-keyword">let</span> x = c.into_inner(); <span class="hljs-comment">//æŠŠä¸å¯å˜cellæ‹†äº†ï¼Œå–å‡ºå…¶å€¼</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2419" data-line-end="2422" class="language-rust"><span class="hljs-comment">//impl&lt;T: Copy&gt;ï¼ˆcopy type Tï¼‰</span>
<span class="hljs-keyword">let</span> x = c.get(); <span class="hljs-comment">//å¤åˆ¶å…¶å€¼</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2424" data-line-end="2431" class="language-rust"><span class="hljs-comment">//impl&lt;T: ?Sized&gt;ï¼ˆä»»æ„ç±»å‹Tï¼‰</span>
*c.get_mut() += <span class="hljs-number">1</span>; <span class="hljs-comment">//è¿”å›å¯å˜å¼•ç”¨</span>

<span class="hljs-keyword">let</span> slice: &amp;<span class="hljs-keyword">mut</span> [<span class="hljs-keyword">i32</span>] = &amp;<span class="hljs-keyword">mut</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> cell_slice: &amp;Cell&lt;[<span class="hljs-keyword">i32</span>]&gt; = Cell::from_mut(slice);
<span class="hljs-keyword">let</span> slice_cell: &amp;[Cell&lt;<span class="hljs-keyword">i32</span>&gt;] = cell_slice.as_slice_of_cells();
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2432" data-line-end="2436">
<p class="has-line-data" data-line-start="2432" data-line-end="2433">RefCell&lt;T&gt;</p>
<p class="has-line-data" data-line-start="2434" data-line-end="2435">è¿è¡Œæ—¶æ£€æŸ¥borrow rulesæ˜¯å¦æ»¡è¶³</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="2437" data-line-end="2443" class="language-rust"><span class="hljs-comment">//impl&lt;T&gt;</span>
<span class="hljs-keyword">let</span> c = RefCell::new(<span class="hljs-number">1</span>);
<span class="hljs-keyword">let</span> x = c.into_inner();
c.replace(<span class="hljs-number">2</span>); <span class="hljs-comment">//panics if the value is currently borrowed</span>
c1.swap(&amp;d); <span class="hljs-comment">//panics if the value in either RefCell is currently borrowed</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2445" data-line-end="2453" class="language-rust"><span class="hljs-comment">//impl&lt;T: ?Sized&gt;</span>
<span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">borrow</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; Ref&lt;<span class="hljs-string">'_</span>, T&gt; {}
<span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">borrow</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; RefMut&lt;<span class="hljs-string">'_</span>, T&gt; {}

<span class="hljs-keyword">let</span> b = c.borrow();
<span class="hljs-keyword">let</span> m = c.borrow_mut();
<span class="hljs-keyword">let</span> b = c.borrow(); <span class="hljs-comment">//panic</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2455" data-line-end="2463" class="language-rust"><span class="hljs-comment">//impl&lt;T: ?Sized&gt;</span>
<span class="hljs-keyword">let</span> m = c.borrow_mut();
<span class="hljs-built_in">assert!</span>(c.try_borrow().is_err());

<span class="hljs-keyword">let</span> m = c.borrow();
<span class="hljs-built_in">assert!</span>(c.try_borrow().is_ok());
<span class="hljs-built_in">assert!</span>(c.try_borrow_mut().is_err());
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2464" data-line-end="2466">ç¤ºä¾‹</li>
</ul>
<pre><code class="has-line-data" data-line-start="2467" data-line-end="2475" class="language-rust"><span class="hljs-comment">//Introducing mutability 'inside' of something immutable</span>
<span class="hljs-keyword">let</span> shared_map: Rc&lt;RefCell&lt;_&gt;&gt; = Rc::new(RefCell::new(HashMap::new()));
{
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> map: RefMut&lt;_&gt; = shared_map.borrow_mut();
    map.insert(<span class="hljs-string">"a"</span>, <span class="hljs-number">1</span>);
}
<span class="hljs-keyword">let</span> total: <span class="hljs-keyword">i32</span> = shared_map.borrow().values().sum();
</code></pre>
<pre><code class="has-line-data" data-line-start="2477" data-line-end="2492" class="language-rust"><span class="hljs-comment">//Implementation details of logically-immutable methods</span>
<span class="hljs-keyword">struct</span> Graph {
    edges: <span class="hljs-built_in">Vec</span>&lt;(<span class="hljs-keyword">i32</span>, <span class="hljs-keyword">i32</span>)&gt;,
    span_tree_cache: RefCell&lt;<span class="hljs-built_in">Option</span>&lt;<span class="hljs-built_in">Vec</span>&lt;(<span class="hljs-keyword">i32</span>, <span class="hljs-keyword">i32</span>)&gt;&gt;&gt;,
}

<span class="hljs-keyword">impl</span> Graph {
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">minimum_spanning_tree</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">Vec</span>&lt;(<span class="hljs-keyword">i32</span>, <span class="hljs-keyword">i32</span>)&gt; {
        <span class="hljs-keyword">self</span>.span_tree_cache.borrow_mut().get_or_insert_with(|| <span class="hljs-keyword">self</span>.calc_span_tree()).clone()
    }
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">calc_span_tree</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">Vec</span>&lt;(<span class="hljs-keyword">i32</span>, <span class="hljs-keyword">i32</span>)&gt; {
        <span class="hljs-built_in">vec!</span>[]
    }
}
</code></pre>
<pre><code class="has-line-data" data-line-start="2494" data-line-end="2498" class="language-rust"><span class="hljs-comment">//Mutating implementations of Clone</span>
<span class="hljs-keyword">let</span> s: Rc&lt;<span class="hljs-built_in">String</span>&gt; = Rc::new(String::from(<span class="hljs-string">"hello"</span>));
<span class="hljs-keyword">let</span> t: Rc&lt;<span class="hljs-built_in">String</span>&gt; = s.clone(); <span class="hljs-comment">//å®é™…ä¿®æ”¹äº†å…±äº«çš„å€¼</span>
</code></pre>
<h3 class="code-line" data-line-start=2499 data-line-end=2500 ><a id="09__2499"></a>09 æšä¸¾</h3>
<h5 class="code-line" data-line-start=2501 data-line-end=2502 ><a id="Cstyple_Enums_2501"></a>C-styple Enums</h5>
<pre><code class="has-line-data" data-line-start="2504" data-line-end="2522" class="language-rust"><span class="hljs-preprocessor">#[repr(i8)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title">Ordering</span> {
    Less,
    Equal,
    Greater,
}
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">compare</span></span>(n: <span class="hljs-keyword">i32</span>, m: <span class="hljs-keyword">i32</span>) -&gt; Ordering {
    <span class="hljs-keyword">if</span> n &lt; m {
        Ordering::Less
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> n &gt; m {
        Ordering::Greater
    } 
    <span class="hljs-keyword">else</span> {
        Equal <span class="hljs-comment">//use std::cmp::Ordering::{self, *}</span>
    }
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2523" data-line-end="2525">å†…å­˜ä¸­è¢«è¡¨ç¤ºä¸ºæ•´æ•°ï¼Œç±»å‹ä¸ºæŸä¸ªåŸºæœ¬æ•´æ•°ç±»å‹ï¼Œç¼ºçœæƒ…å†µä¸‹ä»0å¼€å§‹ç¼–å·</li>
</ul>
<pre><code class="has-line-data" data-line-start="2526" data-line-end="2533" class="language-rust"><span class="hljs-keyword">enum</span> <span class="hljs-title">HttpStatus</span> {
    <span class="hljs-built_in">Ok</span> = <span class="hljs-number">200</span>,
    NotFound = <span class="hljs-number">404</span>,
}
assert_eq(size_of::&lt;Ordering&gt;(), <span class="hljs-number">1</span>);
<span class="hljs-built_in">assert_eq!</span>(size_of::&lt;HttpStatus&gt;(), <span class="hljs-number">2</span>);
</code></pre>
<pre><code class="has-line-data" data-line-start="2535" data-line-end="2538" class="language-rust"><span class="hljs-built_in">assert_eq!</span>(HttpsStatus::<span class="hljs-built_in">Ok</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">i32</span>, <span class="hljs-number">200</span>);
<span class="hljs-comment">//asä¸æ”¯æŒå°†æ•´æ•°è½¬æ¢ä¸ºEnum</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2540" data-line-end="2548" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(n: <span class="hljs-keyword">u32</span>) -&gt; <span class="hljs-built_in">Option</span>&lt;HttpStatus&gt; {
    <span class="hljs-keyword">match</span> n {
        <span class="hljs-number">200</span> =&gt; <span class="hljs-built_in">Some</span>(HttpStatus::<span class="hljs-built_in">Ok</span>),
        ...
        _ =&gt; <span class="hljs-built_in">None</span>,
    }
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2549" data-line-end="2551">derive traits and attach methods</li>
</ul>
<pre><code class="has-line-data" data-line-start="2552" data-line-end="2561" class="language-rust"><span class="hljs-keyword">impl</span> TimeUnit {
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(<span class="hljs-keyword">self</span>) -&gt; &amp;<span class="hljs-string">'static</span> <span class="hljs-keyword">str</span> {
        <span class="hljs-keyword">match</span> <span class="hljs-keyword">self</span> {
            TimeUnit::Seconds =&gt; <span class="hljs-string">"seconds"</span>,
            TimeUnit::Minutes =&gt; <span class="hljs-string">"minutes"</span>,
        }
    }
}
</code></pre>
<h5 class="code-line" data-line-start=2562 data-line-end=2563 ><a id="Enums_with_Data_2562"></a>Enums with Data</h5>
<pre><code class="has-line-data" data-line-start="2565" data-line-end="2571" class="language-rust"><span class="hljs-keyword">enum</span> <span class="hljs-title">S</span> {
    A, <span class="hljs-comment">//Unit variant/constructor</span>
    B(<span class="hljs-keyword">u32</span>, <span class="hljs-keyword">u32</span>), <span class="hljs-comment">//Tuple variant/constructor</span>
    C{ x: <span class="hljs-keyword">u32</span>, y: <span class="hljs-keyword">u32</span> }, <span class="hljs-comment">//Struct variant/constructor</span>
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2572" data-line-end="2574">Enumä¸æ¯ä¸€ä¸ªvariantä»¥åŠvariantçš„æ¯ä¸ªfieldå…·æœ‰ç›¸åŒå¯è§æ€§</li>
</ul>
<h5 class="code-line" data-line-start=2574 data-line-end=2575 ><a id="Enum_in_Memory_2574"></a>Enum in Memory</h5>
<ul>
<li class="has-line-data" data-line-start="2576" data-line-end="2578">åŒ…å«ä¸¤éƒ¨åˆ†ï¼ša small integer tag to distinguish variantï¼›enough memory to hold the largest variant</li>
</ul>
<h5 class="code-line" data-line-start=2578 data-line-end=2579 ><a id="Rich_Data_Structure_with_Enus_2578"></a>Rich Data Structure with Enus</h5>
<pre><code class="has-line-data" data-line-start="2581" data-line-end="2590" class="language-rust"><span class="hljs-keyword">enum</span> <span class="hljs-title">Json</span> {
    Null,
    Boolean(<span class="hljs-keyword">bool</span>),
    Number(<span class="hljs-keyword">f64</span>),
    <span class="hljs-built_in">String</span>(<span class="hljs-built_in">String</span>),
    Array(<span class="hljs-built_in">Vec</span>&lt;Json&gt;),
    Object(<span class="hljs-built_in">Box</span>&lt;HashMap&lt;<span class="hljs-built_in">String</span>, Json&gt;&gt;)
}
</code></pre>
<h5 class="code-line" data-line-start=2591 data-line-end=2592 ><a id="Generic_Enums_2591"></a>Generic Enums</h5>
<pre><code class="has-line-data" data-line-start="2594" data-line-end="2601" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title">Option</span>&lt;T&gt; {
    <span class="hljs-built_in">None</span>, <span class="hljs-built_in">Some</span>(T),
}
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title">Result</span>&lt;T, E&gt; {
    <span class="hljs-built_in">Ok</span>(T), <span class="hljs-built_in">Err</span>(E),
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2602" data-line-end="2604">å¦‚æœTæ˜¯refã€Boxã€å…¶ä»–smart pointerï¼ŒRustç¼–è¯‘å™¨ä¼šæ¶ˆé™¤Option&lt;T&gt;è¡¨ç¤ºä¸­çš„tagï¼ˆ0è¡¨ç¤ºNoneï¼Œé0è¡¨ç¤ºpointerï¼‰</li>
</ul>
<h5 class="code-line" data-line-start=2604 data-line-end=2605 ><a id="Enums_2604"></a>Enumså­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜</h5>
<ul>
<li class="has-line-data" data-line-start="2606" data-line-end="2608">åˆ¤æ–­ETç±»å‹å˜é‡eæ˜¯ETä¸­çš„å“ªä¸€ä¸ªvariantï¼špattern matching</li>
</ul>
<h3 class="code-line" data-line-start=2608 data-line-end=2609 ><a id="10__2608"></a>10 æ¨¡å¼åŒ¹é…</h3>
<h5 class="code-line" data-line-start=2610 data-line-end=2611 ><a id="Enum_2610"></a>Enum</h5>
<pre><code class="has-line-data" data-line-start="2613" data-line-end="2622" class="language-rust"><span class="hljs-keyword">impl</span> TimeUnit {
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">plural</span></span>(<span class="hljs-keyword">self</span>) -&gt; &amp;<span class="hljs-string">'static</span> <span class="hljs-keyword">str</span> {
        <span class="hljs-keyword">match</span> <span class="hljs-keyword">self</span> {
            TimeUnit::Second =&gt; <span class="hljs-string">"seconds"</span>,
            TimeUnit::Minute =&gt; <span class="hljs-string">"minutes"</span>,
            TimeUnit::Hour =&gt; <span class="hljs-string">"hours"</span>,
    }
}
</code></pre>
<pre><code class="has-line-data" data-line-start="2624" data-line-end="2634" class="language-rust"><span class="hljs-keyword">impl</span> RoughTime {
    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">to_english</span></span>(<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">String</span> {
        <span class="hljs-keyword">match</span> <span class="hljs-keyword">self</span> {
            RoughTime::InThePast(TimeUnit::Hour, <span class="hljs-number">1</span>) =&gt; {},
            RoughTime::InThePast(unit, <span class="hljs-number">1</span>) =&gt; {},
            RoughTime::InThePast(unit, count) =&gt; {},
        }
    }
}
</code></pre>
<h5 class="code-line" data-line-start=2635 data-line-end=2636 ><a id="literal_pattern_variable_pattern_wildcard_pattern_2635"></a>literal pattern, variable pattern, wildcard pattern</h5>
<ul>
<li class="has-line-data" data-line-start="2637" data-line-end="2639">literal pattern, variable pattern</li>
</ul>
<pre><code class="has-line-data" data-line-start="2640" data-line-end="2645" class="language-rust"><span class="hljs-keyword">match</span> x {
    <span class="hljs-number">0</span> =&gt; {},
    n =&gt; pritln!(<span class="hljs-string">"{}"</span>, n),
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2646" data-line-end="2648">wildcard pattern</li>
</ul>
<pre><code class="has-line-data" data-line-start="2649" data-line-end="2654" class="language-rust"><span class="hljs-keyword">match</span> x {
    <span class="hljs-number">0</span> =&gt; {},
    _ =&gt; {},
}
</code></pre>
<h5 class="code-line" data-line-start=2655 data-line-end=2656 ><a id="tuple_pattern_struct_pattern_2655"></a>tuple pattern, struct pattern</h5>
<ul>
<li class="has-line-data" data-line-start="2657" data-line-end="2659">tuple pattern</li>
</ul>
<pre><code class="has-line-data" data-line-start="2660" data-line-end="2666" class="language-rust"><span class="hljs-keyword">match</span> (x.cmp(&amp;<span class="hljs-number">0</span>), y.cmp(&amp;<span class="hljs-number">0</span>)) {
    (Equal, Equal) =&gt; {},
    (_, Equal) =&gt; {},
    _ =&gt; {},
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2667" data-line-end="2669">struct pattern</li>
</ul>
<pre><code class="has-line-data" data-line-start="2670" data-line-end="2675" class="language-rust"><span class="hljs-keyword">match</span> s {
    Point { x: <span class="hljs-number">0</span>, y: height } =&gt; {},
    Point { x: x, y: y } =&gt; {},
}
</code></pre>
<pre><code class="has-line-data" data-line-start="2677" data-line-end="2686" class="language-rust"><span class="hljs-keyword">match</span> s {
    Account { name, language, id: _, status: _, address: _ } =&gt; {},
    ...
}
<span class="hljs-keyword">match</span> s {
    Account { name, language, .. } =&gt; {}, <span class="hljs-comment">//..çœç•¥ç¬¦</span>
    ...
}
</code></pre>
<h5 class="code-line" data-line-start=2687 data-line-end=2688 ><a id="array_pattern_slice_pattern_2687"></a>array pattern, slice pattern</h5>
<pre><code class="has-line-data" data-line-start="2690" data-line-end="2695" class="language-rust"><span class="hljs-keyword">match</span> a {
    [_, _, <span class="hljs-number">0</span>] =&gt; [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
    ...
}
</code></pre>
<pre><code class="has-line-data" data-line-start="2697" data-line-end="2704" class="language-rust"><span class="hljs-keyword">match</span> a {
    [] =&gt; {},
    [x] =&gt; {},
    [x, y] =&gt; {},
    [x, .., y] =&gt; {},
}
</code></pre>
<h5 class="code-line" data-line-start=2705 data-line-end=2706 ><a id="reference_pattern_2705"></a>reference pattern</h5>
<pre><code class="has-line-data" data-line-start="2708" data-line-end="2721" class="language-rust"><span class="hljs-keyword">match</span> account {
    Account { name, .. } =&gt; {
        f(&amp;name);
        g(account); <span class="hljs-comment">//å‡è®¾nameä¸æ˜¯copy typeï¼Œerror</span>
    }
}
<span class="hljs-keyword">match</span> account {
    Account { <span class="hljs-keyword">ref</span> name, <span class="hljs-keyword">ref</span> <span class="hljs-keyword">mut</span> x, .. } =&gt; {
        f(name); <span class="hljs-comment">//ä»¥å¼•ç”¨æ–¹å¼æŒ‡å‘åŒ¹é…çš„å€¼</span>
        g(account); <span class="hljs-comment">//ok</span>
    }
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2722" data-line-end="2724">&amp; pattern</li>
</ul>
<pre><code class="has-line-data" data-line-start="2725" data-line-end="2729" class="language-rust"><span class="hljs-keyword">match</span> s.center() { <span class="hljs-comment">//å‡è®¾è¿”å›å¼•ç”¨&amp;Pointer</span>
    &amp;Pointer { x, y } =&gt; {} <span class="hljs-comment">//è‹¥x, yä¸æ˜¯copy typeåˆ™ç¼–è¯‘é”™è¯¯ï¼Œæ— æ³•ä»å…±äº«å¼•ç”¨ä¸­move outä¸€ä¸ªå€¼</span>
}
</code></pre>
<h5 class="code-line" data-line-start=2730 data-line-end=2731 ><a id="Match_Guards_2730"></a>Match Guards</h5>
<pre><code class="has-line-data" data-line-start="2733" data-line-end="2741" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(x: <span class="hljs-keyword">i64</span>) {
    <span class="hljs-keyword">match</span> s {
        <span class="hljs-built_in">None</span> =&gt; {},
        <span class="hljs-built_in">Some</span>(x) =&gt; {}, <span class="hljs-comment">//ä¸€ä¸ªå…¨æ–°çš„å˜é‡è¦†ç›–x</span>
        <span class="hljs-built_in">Some</span>(other) =&gt; {},
    }
}
</code></pre>
<pre><code class="has-line-data" data-line-start="2743" data-line-end="2751" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>(x: <span class="hljs-keyword">i64</span>) {
    <span class="hljs-keyword">match</span> s {
        <span class="hljs-built_in">None</span> =&gt; {},
        <span class="hljs-built_in">Some</span>(y) <span class="hljs-keyword">if</span> y == x =&gt; {},
        <span class="hljs-built_in">Some</span>(y) =&gt; {},
    }
}
</code></pre>
<h5 class="code-line" data-line-start=2752 data-line-end=2753 ><a id="Matching_Multiple_Possibilities_2752"></a>Matching Multiple Possibilities</h5>
<pre><code class="has-line-data" data-line-start="2755" data-line-end="2761" class="language-rust"><span class="hljs-keyword">match</span> c {
    <span class="hljs-string">'a'</span>..=<span class="hljs-string">'z'</span> | <span class="hljs-string">'A'</span>..=<span class="hljs-string">'Z'</span> =&gt; {},
    <span class="hljs-string">'0'</span>..=<span class="hljs-string">'9'</span> =&gt; {},
    _ =&gt; {},
}
</code></pre>
<h5 class="code-line" data-line-start=2762 data-line-end=2763 ><a id="Bingding_with__Patterns_2762"></a>Bingding with @ Patterns</h5>
<pre><code class="has-line-data" data-line-start="2765" data-line-end="2772" class="language-rust"><span class="hljs-keyword">match</span> s {
    Shape::Rect(top_left, bottom_right) =&gt; {
        paint(&amp;Shape::Rect(top_left, bottom_right))
    }
    _ {}
}
</code></pre>
<pre><code class="has-line-data" data-line-start="2774" data-line-end="2781" class="language-rust"><span class="hljs-keyword">match</span> s {
    rect @ Shape::Rect(..) =&gt; {
        paint(&amp;rect)
    }
    _ {}
}
</code></pre>
<h5 class="code-line" data-line-start=2782 data-line-end=2783 ><a id="Pattern_Matching__2782"></a>Pattern Matching å…¶ä»–å¯ä»¥ä½¿ç”¨çš„åœ°æ–¹</h5>
<pre><code class="has-line-data" data-line-start="2785" data-line-end="2797" class="language-rust"><span class="hljs-keyword">let</span> Track { album, title, .. } = song; 

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">dis</span></span>((x, y): (<span class="hljs-keyword">f64</span>, <span class="hljs-keyword">f64</span>)) {}

<span class="hljs-keyword">for</span> (id, d) <span class="hljs-keyword">in</span> &amp;cache_map {}

<span class="hljs-keyword">let</span> sum = numbers.fold(<span class="hljs-number">0</span>, |a, &amp;num| a + num);

<span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-built_in">Some</span>(_) = x {}

<span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-built_in">Err</span>(err) = f() {}
</code></pre>
<h5 class="code-line" data-line-start=2798 data-line-end=2799 ><a id="Binary_Tree__2798"></a>Binary Tree ç¤ºä¾‹</h5>
<pre><code class="has-line-data" data-line-start="2801" data-line-end="2823" class="language-rust"><span class="hljs-keyword">impl</span>&lt;T: <span class="hljs-built_in">Ord</span>&gt; BinaryTree&lt;T&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">add</span></span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>, value: T) {
        <span class="hljs-keyword">match</span> *<span class="hljs-keyword">self</span> {
            BinaryTree::Empty =&gt; {
                *<span class="hljs-keyword">self</span> = BinaryTree::NonEmpty(Box::new(TreeNode {
                    element: value,
                    left: BinaryTree::Empty,
                    right: BinaryTree::Empty,
                }))
            }
            BinaryTree::NonEmpty(<span class="hljs-keyword">ref</span> <span class="hljs-keyword">mut</span> node) =&gt; {
                <span class="hljs-keyword">if</span> value &lt;= node.element {
                    node.left.add(value);
                }
                <span class="hljs-keyword">else</span> {
                    node.right.add(value);
                }
            }
        }
    }
}
</code></pre>
<h3 class="code-line" data-line-start=2824 data-line-end=2825 ><a id="11_Trait_and_Generic_2824"></a>11 Trait and Generic</h3>
<h5 class="code-line" data-line-start=2826 data-line-end=2827 ><a id="Trait_2826"></a>Trait</h5>
<ul>
<li class="has-line-data" data-line-start="2828" data-line-end="2830">å®šä¹‰ç¤ºä¾‹</li>
</ul>
<pre><code class="has-line-data" data-line-start="2831" data-line-end="2835" class="language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">trait</span> <span class="hljs-title">Write</span> {
    ...
}
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2836" data-line-end="2838">ä½¿ç”¨ç¤ºä¾‹</li>
</ul>
<pre><code class="has-line-data" data-line-start="2839" data-line-end="2848" class="language-rust"><span class="hljs-comment">//Trait Object</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">say_hello</span></span>(out: &amp;<span class="hljs-keyword">mut</span> dyn Write) -&gt; std::io::<span class="hljs-built_in">Result</span>&lt;()&gt; {}

<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> bytes = <span class="hljs-built_in">vec!</span>[]; <span class="hljs-comment">//å®ç°äº†Write</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> file = File::create(<span class="hljs-string">"hello.txt"</span>)?; <span class="hljs-comment">//å®ç°äº†Write</span>

say_hello(&amp;<span class="hljs-keyword">mut</span> bytes)?;
sya_hello(&amp;<span class="hljs-keyword">mut</span> file)?;
</code></pre>
<pre><code class="has-line-data" data-line-start="2850" data-line-end="2853" class="language-rust"><span class="hljs-comment">//Trait Bound on type parameters in generic functions</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">min</span></span>&lt;T: <span class="hljs-built_in">Ord</span>&gt;(value1: T, value2: T) -&gt; T {}
</code></pre>
<h5 class="code-line" data-line-start=2854 data-line-end=2855 ><a id="Trait_2854"></a>Traitçš„ä½¿ç”¨</h5>
<ul>
<li class="has-line-data" data-line-start="2856" data-line-end="2862">
<p class="has-line-data" data-line-start="2856" data-line-end="2857">éœ€è¦ç¡®ä¿traitè¢«å¼•å…¥åˆ°å½“å‰ä½œç”¨åŸŸ</p>
<p class="has-line-data" data-line-start="2858" data-line-end="2859">ä¸€ä¸ªç±»å‹å¯èƒ½å®ç°å¤šä¸ªtraitï¼Œæ˜¾å¼å¼•å…¥æ‰€éœ€traitå‡å°‘åç§°å†²çª</p>
<p class="has-line-data" data-line-start="2860" data-line-end="2861">std::preludeå·²ç»å¼•å…¥å¾ˆå¤štraits</p>
</li>
<li class="has-line-data" data-line-start="2862" data-line-end="2868">
<p class="has-line-data" data-line-start="2862" data-line-end="2863">Trait Object</p>
<p class="has-line-data" data-line-start="2864" data-line-end="2865">a ref to a value with a trait type</p>
<p class="has-line-data" data-line-start="2866" data-line-end="2867">vtableã€data</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="2869" data-line-end="2872" class="language-rust"><span class="hljs-keyword">let</span> writer: dy Write = buf; <span class="hljs-comment">//error</span>
<span class="hljs-keyword">let</span> writer: &amp;<span class="hljs-keyword">mut</span> dyn Write = &amp;<span class="hljs-keyword">mut</span> buf;
</code></pre>
<pre><code class="has-line-data" data-line-start="2874" data-line-end="2878" class="language-rust"><span class="hljs-comment">//è‡ªåŠ¨è½¬æ¢</span>
say_hello(&amp;<span class="hljs-keyword">mut</span> file)?;
<span class="hljs-keyword">let</span> w: <span class="hljs-built_in">Box</span>&lt;dy Write&gt; = Box::new(file);
</code></pre>
<ul>
<li class="has-line-data" data-line-start="2879" data-line-end="2885">
<p class="has-line-data" data-line-start="2879" data-line-end="2880">Trait Object VS Type Parameter</p>
<p class="has-line-data" data-line-start="2881" data-line-end="2882">Trait Objectï¼šDynamic Dispatchï¼ˆåœ¨è¿è¡Œæ—¶åˆ»æŸ¥æ‰¾vtableç¡®å®šè°ƒç”¨æ–¹æ³•çš„åœ°å€ï¼‰</p>
<p class="has-line-data" data-line-start="2883" data-line-end="2884">Type Parameterï¼šStatic Dispatchï¼ˆåœ¨ç¼–è¯‘æ—¶åˆ»ç¡®å®šè°ƒç”¨æ–¹æ³•çš„åœ°å€ï¼‰</p>
</li>
<li class="has-line-data" data-line-start="2885" data-line-end="2887">
<p class="has-line-data" data-line-start="2885" data-line-end="2886">Generic function</p>
</li>
</ul>
<pre><code class="has-line-data" data-line-start="2888" data-line-end="2892" class="language-rust"><span class="hljs-keyword">let</span> v1 = (<span class="hljs-number">0</span>..<span class="hljs-number">1000</span>).collect(); <span class="hljs-comment">//error</span>
<span class="hljs-keyword">let</span> v2: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt; = (<span class="hljs-number">0</span>..<span class="hljs-number">1000</span>).colloct(); <span class="hljs-comment">//ok</span>
<span class="hljs-keyword">let</span> v3: (<span class="hljs-number">0</span>..<span class="hljs-number">1000</span>).collect::&lt;<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt;&gt;(); <span class="hljs-comment">//ok</span>
</code></pre>
<pre><code class="has-line-data" data-line-start="2894" data-line-end="2899" class="language-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>&lt;T: Debug + Hash + <span class="hljs-built_in">Eq</span>&gt;() {}
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>&lt;T&gt;() 
    <span class="hljs-keyword">where</span> T: Debug + Hash + <span class="hljs-built_in">Eq</span> 
{}
</code></pre>
<pre><code class="has-line-data" data-line-start="2901" data-line-end="2904" class="language-rust"><span class="hljs-comment">//Lifetiem parameteréœ€è¦æ”¾åœ¨Type parameterä¹‹å‰</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">f</span></span>&lt;<span class="hljs-string">'t</span>, <span class="hljs-string">'c</span>, P&gt;() {}
</code></pre>
</div>
</body>
</html>
